

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mcscf — Multi-configurational self-consistent field &mdash; PySCF 1.4.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PySCF 1.4.0 documentation" href="index.html"/>
        <link rel="next" title="fci — Full configuration interaction" href="fci.html"/>
        <link rel="prev" title="ao2mo — Integral transformations" href="ao2mo.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> PySCF
          

          
          </a>

          
            
            
              <div class="version">
                1.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">An overview of PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="gto.html">gto &#8212; Molecular structure and GTO basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="lib.html">lib &#8212; Helper functions, parameters, and C extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="scf.html">scf &#8212; Mean-field methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="ao2mo.html">ao2mo &#8212; Integral transformations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">mcscf &#8212; Multi-configurational self-consistent field</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#casscf-active-space-solver">CASSCF active space solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dmrg-solver">DMRG solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fciqmc-solver">FCIQMC solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#state-average-fci-solver">State-average FCI solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="#state-average-with-mixed-solver">State-average with mixed solver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#symmetry-broken">Symmetry broken</a></li>
<li class="toctree-l2"><a class="reference internal" href="#initial-guess">Initial guess</a></li>
<li class="toctree-l2"><a class="reference internal" href="#canonical-orbitals">Canonical orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#program-reference">Program reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscf.mcscf.casci">CASCI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscf.mcscf.mc1step">CASSCF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyscf.mcscf.addons">addons</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fci.html">fci &#8212; Full configuration interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="symm.html">symm &#8211; Point group symmetry and spin symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="df.html">df &#8212; Density fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="dft.html">dft &#8212; Density functional theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="tddft.html">tddft &#8212; Time dependent density functional theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="cc.html">cc &#8212; Coupled cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="ci.html">ci &#8212; Configuration interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dmrgscf.html">dmrgscf</a></li>
<li class="toctree-l1"><a class="reference internal" href="fciqmcscf.html">fciqmcscf</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="grad.html">grad &#8212; Analytical nuclear gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="hessian.html">hessian &#8212; Analytical nuclear Hessian</a></li>
<li class="toctree-l1"><a class="reference internal" href="pbc.html">pbc &#8212; Periodic boundary conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="lo.html">lo &#8212; Orbital localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="qmmm.html">qmmm &#8212; QM/MM interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrpt.html">mrpt &#8212; Multi-reference perturbation theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="code-rule.html">Code standard</a></li>
<li class="toctree-l1"><a class="reference internal" href="version.html">Version history</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PySCF</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>mcscf &#8212; Multi-configurational self-consistent field</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/mcscf.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pyscf.mcscf">
<span id="mcscf-multi-configurational-self-consistent-field"></span><h1>mcscf &#8212; Multi-configurational self-consistent field<a class="headerlink" href="#module-pyscf.mcscf" title="Permalink to this headline">¶</a></h1>
<p>CASCI and CASSCF</p>
<p>Simple usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-108.980200816243354</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.044401882238134</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cas_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span> <span class="c1"># pick orbitals for CAS space, 1-based indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">sort_mo</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">,</span> <span class="n">cas_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mo</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.007378939813691</span>
</pre></div>
</div>
<p><code class="xref py py-func docutils literal"><span class="pre">mcscf.CASSCF()</span></code> or <code class="xref py py-func docutils literal"><span class="pre">mcscf.CASCI()</span></code> returns a proper instance of CASSCF/CASCI class.
There are some parameters to control the CASSCF/CASCI method.</p>
<blockquote>
<div><dl class="docutils">
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level.  Default value equals to <code class="xref py py-class docutils literal"><span class="pre">Mole.verbose</span></code>.</dd>
<dt>max_memory</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>Allowed memory in MB.  Default value equals to <code class="xref py py-class docutils literal"><span class="pre">Mole.max_memory</span></code>.</dd>
<dt>ncas</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Active space size.</dd>
<dt>nelecas</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">tuple of int</span><dd>Active (nelec_alpha, nelec_beta)</dd>
<dt>ncore</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int or tuple of int</span><dd>Core electron number.  In UHF-CASSCF, it&#8217;s a tuple to indicate the different core eletron numbers.</dd>
<dt>natorb</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Whether to restore the natural orbital during CASSCF optimization. Default is not.</dd>
<dt>canonicalization</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Whether to canonicalize orbitals.  Default is True.</dd>
<dt>fcisolver</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">an instance of <code class="xref py py-class docutils literal"><span class="pre">FCISolver</span></code></span><dd><p class="first">The pyscf.fci module provides several FCISolver for different scenario.  Generally,
fci.direct_spin1.FCISolver can be used for all RHF-CASSCF.  However, a proper FCISolver
can provide better performance and better numerical stability.  One can either use
<code class="xref py py-func docutils literal"><span class="pre">fci.solver()</span></code> function to pick the FCISolver by the program or manually assigen
the FCISolver to this attribute, e.g.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">singlet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCISolver</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<p>You can control FCISolver by setting e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">max_cycle</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">7</span>
</pre></div>
</div>
<p>For more details of the parameter for FCISolver, See <code class="xref py py-mod docutils literal"><span class="pre">fci</span></code>.</p>
<p class="last">By replacing this fcisolver, you can easily use the CASCI/CASSCF solver
with other FCI replacements,  such as DMRG, QMC.  See <code class="xref py py-mod docutils literal"><span class="pre">dmrgscf</span></code> and
<code class="xref py py-mod docutils literal"><span class="pre">fciqmcscf</span></code>.</p>
</dd>
</dl>
</div></blockquote>
<p>The Following attributes are used for CASSCF</p>
<blockquote>
<div><dl class="docutils">
<dt>conv_tol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Converge threshold.  Default is 1e-7</dd>
<dt>conv_tol_grad</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Converge threshold for CI gradients and orbital rotation gradients.
Default is 1e-4</dd>
<dt>max_stepsize</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd><p class="first">The step size for orbital rotation.  Small step size is prefered.
Default is 0.03.  
(NOTE although the default step size is small enough for many systems,
it happens that the orbital optimizor crosses the barriar of local
minimum and converge to the neighbour solution, e.g. the CAS(4,4) for
C2H4 in the test files.  In these cases, one need to fine the
optimization by reducing max_stepsize, max_ci_stepsize and
max_cycle_micro, max_cycle_micro_inner and ah_start_tol.)</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">max_stepsize</span> <span class="o">=</span> <span class="o">.</span><span class="mi">01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">max_cycle_micro</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">max_cycle_macro</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">max_cycle_micro_inner</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_start_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">6</span>
</pre></div>
</div>
</dd>
<dt>max_ci_stepsize</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>The max size for approximate CI updates.  The approximate updates are
used in 1-step algorithm, to estimate the change of CI wavefunction wrt
the orbital rotation.  Small step size is prefered.  Default is 0.01.</dd>
<dt>max_cycle_macro</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Max number of macro iterations.  Default is 50.</dd>
<dt>max_cycle_micro</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Max number of micro iterations in each macro iteration.  Depending on
systems, increasing this value might reduce the total macro
iterations.  Generally, 2 - 3 steps should be enough.  Default is 2.</dd>
<dt>max_cycle_micro_inner</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Max number of steps for the orbital rotations allowed for the augmented
hessian solver.  It can affect the actual size of orbital rotation.
Even with a small max_stepsize, a few max_cycle_micro_inner can
accumulate the rotation and leads to a significant change of the CAS
space.  Depending on systems, increasing this value migh reduce the
total number of macro iterations.  The value between 2 - 8 is preferred.
Default is 4.</dd>
<dt>frozen</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int or list</span><dd>If integer is given, the inner-most orbitals are excluded from optimization.
Given the orbital indices (0-based) in a list, any doubly occupied core
orbitals, active orbitals and external orbitals can be frozen.</dd>
<dt>ah_level_shift</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float, for AH solver.</span><dd>Level shift for the Davidson diagonalization in AH solver.  Default is 0.</dd>
<dt>ah_conv_tol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float, for AH solver.</span><dd>converge threshold for Davidson diagonalization in AH solver.  Default is 1e-8.</dd>
<dt>ah_max_cycle</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float, for AH solver.</span><dd>Max number of iterations allowd in AH solver.  Default is 20.</dd>
<dt>ah_lindep</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float, for AH solver.</span><dd>Linear dependence threshold for AH solver.  Default is 1e-16.</dd>
<dt>ah_start_tol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">flat, for AH solver.</span><dd>In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 1e-4.</dd>
<dt>ah_start_cycle</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int, for AH solver.</span><dd><p class="first">In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 3.</p>
<p><code class="docutils literal"><span class="pre">ah_conv_tol</span></code>, <code class="docutils literal"><span class="pre">ah_max_cycle</span></code>, <code class="docutils literal"><span class="pre">ah_lindep</span></code>, <code class="docutils literal"><span class="pre">ah_start_tol</span></code> and <code class="docutils literal"><span class="pre">ah_start_cycle</span></code>
can affect the accuracy and performance of CASSCF solver.  Lower
<code class="docutils literal"><span class="pre">ah_conv_tol</span></code> and <code class="docutils literal"><span class="pre">ah_lindep</span></code> can improve the accuracy of CASSCF
optimization, but slow down the performance.</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-109.044401898486001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-109.044401887945668</span>
</pre></div>
</div>
</dd>
<dt>chkfile</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>Checkpoint file to save the intermediate orbitals during the CASSCF optimization.
Default is the checkpoint file of mean field object.</dd>
</dl>
</div></blockquote>
<p>Saved results</p>
<blockquote>
<div><dl class="docutils">
<dt>e_tot</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Total MCSCF energy (electronic energy plus nuclear repulsion)</dd>
<dt>ci</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>CAS space FCI coefficients</dd>
<dt>converged</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool, for CASSCF only</span><dd>It indicates CASSCF optimization converged or not.</dd>
<dt>mo_energy: ndarray,</dt>
<dd>Diagonal elements of general Fock matrix</dd>
<dt>mo_coeff</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray, for CASSCF only</span><dd>Optimized CASSCF orbitals coefficients
Note the orbitals are NOT natural orbitals by default.  There are two
inbuilt methods to convert the mo_coeff to natural orbitals.
1. Set .natorb attribute.  It can be used before calculation.
2. call .cas_natorb_ method after the calculation to in-place convert the orbitals</dd>
</dl>
</div></blockquote>
<div class="section" id="casscf-active-space-solver">
<h2>CASSCF active space solver<a class="headerlink" href="#casscf-active-space-solver" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dmrg-solver">
<h3>DMRG solver<a class="headerlink" href="#dmrg-solver" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="fciqmc-solver">
<h3>FCIQMC solver<a class="headerlink" href="#fciqmc-solver" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="state-average-fci-solver">
<h3>State-average FCI solver<a class="headerlink" href="#state-average-fci-solver" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="state-average-with-mixed-solver">
<h3>State-average with mixed solver<a class="headerlink" href="#state-average-with-mixed-solver" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="symmetry-broken">
<h2>Symmetry broken<a class="headerlink" href="#symmetry-broken" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="initial-guess">
<h2>Initial guess<a class="headerlink" href="#initial-guess" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="canonical-orbitals">
<h2>Canonical orbitals<a class="headerlink" href="#canonical-orbitals" title="Permalink to this headline">¶</a></h2>
<p>There are two relevant parameters for orbital canonicalization.  They are
<code class="xref py py-attr docutils literal"><span class="pre">mc.canonicalization</span></code> and <code class="xref py py-attr docutils literal"><span class="pre">mc.natorb</span></code> (assuming the MCSCF object is <code class="docutils literal"><span class="pre">mc</span></code>).
In the CASCI/CASSCF calculations, the resultant orbitals are stored in the
attribute <code class="xref py py-attr docutils literal"><span class="pre">mc.mo_coeff</span></code>.  These orbitals may be identical or partially
identical to the initial orbitals, depending on the values of
<code class="xref py py-attr docutils literal"><span class="pre">mc.canonicalization</span></code> and <code class="xref py py-attr docutils literal"><span class="pre">mc.natorb</span></code>.</p>
<p><code class="xref py py-attr docutils literal"><span class="pre">mc.canonicalization</span></code> controls whether the resultant CASCI/CASSCF orbitals
are canonicalized with respect to the general Fock matrix.  General Fock matrix
is defined as</p>
<div class="math">
\[\begin{split}\mathbf{F} &amp;= \mathbf{h}_{core} + \mathbf{J} - \mathbf{K} \\
J_{pq} &amp;= \sum_{rs} (pq|rs) \gamma_{sr} \\
K_{pq} &amp;= \sum_{qr} (pq|rs) \gamma_{qr} \\\end{split}\]</div>
<p><span class="math">\(\gamma\)</span> is the total density matrix which is the summation of doubly
occupied core density matrix and correlated density matrix in active space.
If <code class="xref py py-attr docutils literal"><span class="pre">mc.canonicalization</span></code> is enabled, the CASCI/CASSCF program will call
the <code class="xref py py-func docutils literal"><span class="pre">mc.canonicalize()</span></code> function to diagonalize the core and external space
wrt the general Fock matrix.  The eigenvalues of the core and external subspace
are stored in attribute <code class="xref py py-attr docutils literal"><span class="pre">mc.mo_energy</span></code>.
By default, <code class="xref py py-attr docutils literal"><span class="pre">mc.canonicalization</span></code> is enabled because the canonicalized
MCSCF orbitals can simplify the algorithm of MRPT methods.</p>
<p><code class="xref py py-attr docutils literal"><span class="pre">mc.natorb</span></code> controls whether the CASCI/CASSCF active space orbitals are
transformed to natural orbitals of the correlated density matrix.  When this
parameter is enabled, the natural orbitals will be stored in the active part of
the attribute <code class="xref py py-attr docutils literal"><span class="pre">mc.mo_coeff</span></code> and the CI coefficients <code class="xref py py-attr docutils literal"><span class="pre">mc.ci</span></code> (if
applicable) will be transformed accordingly.
By default <code class="xref py py-attr docutils literal"><span class="pre">mc.natorb</span></code> is disabled and it is important for the MCSCF solver.
Generally, the value of <code class="xref py py-attr docutils literal"><span class="pre">mc.natorb</span></code> does not affect (the default) FCI
solver because an independent CASCI calculation following a previous MCSCF
calculation should give the same solutions no matter <code class="xref py py-attr docutils literal"><span class="pre">mc.natorb</span></code> is enabled
or not.  But this is not true for some external large active space solvers such
as DMRG, selected CI methods.  The CASCI calculation may produce different
answers depending on the value of <code class="xref py py-attr docutils literal"><span class="pre">mc.natorb</span></code>.  Therefore, it is
recommended to disable <code class="xref py py-attr docutils literal"><span class="pre">mc.natorb</span></code> in your calculation.</p>
<p>Following presents what the <code class="xref py py-attr docutils literal"><span class="pre">mc.mo_coeff</span></code> would be like for different
combinations of <code class="xref py py-attr docutils literal"><span class="pre">mc.canonicalization</span></code> and <code class="xref py py-attr docutils literal"><span class="pre">mc.natorb</span></code> in a
CASCI calculation:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">mc.canonicalization</span> <span class="pre">=</span> <span class="pre">False</span></code> and <code class="docutils literal"><span class="pre">mc.natorb</span> <span class="pre">=</span> <span class="pre">False</span></code>:</li>
</ul>
<p>The resultant orbitals <code class="xref py py-attr docutils literal"><span class="pre">mc.mo_coeff</span></code> are identical to the input orbitals.
If the CASCI was initialized with a RHF calculation,  <code class="xref py py-attr docutils literal"><span class="pre">mc.mo_coeff</span></code> points
to RHF orbitals.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">mc.canonicalization</span> <span class="pre">=</span> <span class="pre">True</span></code> and <code class="docutils literal"><span class="pre">mc.natorb</span> <span class="pre">=</span> <span class="pre">False</span></code>:</li>
</ul>
<p>Core part and external part of <code class="xref py py-attr docutils literal"><span class="pre">mc.mo_coeff</span></code> are canonicalized orbitals,
which diagonalize the core and external blocks of general Fock matrix.  The
orbitals in active space are identical to the active orbitals in the input.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">mc.canonicalization</span> <span class="pre">=</span> <span class="pre">False</span></code> and <code class="docutils literal"><span class="pre">mc.natorb</span> <span class="pre">=</span> <span class="pre">True</span></code></li>
</ul>
<p>Core and external part of <code class="xref py py-attr docutils literal"><span class="pre">mc.mo_coeff</span></code> are identical to the core and
external part of the input orbitals.  Active space orbitals are transformed to
the natural orbitals of the correlated density matrix.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">mc.canonicalization</span> <span class="pre">=</span> <span class="pre">True</span></code> and <code class="docutils literal"><span class="pre">mc.natorb</span> <span class="pre">=</span> <span class="pre">True</span></code></li>
</ul>
<p><code class="xref py py-attr docutils literal"><span class="pre">mc.mo_coeff</span></code> are completely different to the input orbitals.</p>
<p>There is another parameter <code class="xref py py-attr docutils literal"><span class="pre">mc.sorting_mo_energy</span></code> which may affect the
ordering of MCSCF orbitals when <code class="xref py py-attr docutils literal"><span class="pre">mc.canonicalization</span></code> or <code class="xref py py-attr docutils literal"><span class="pre">mc.natorb</span></code>
is enabled.  Generally, the canonical orbitals in the core and external space
are sorted by the orbital energies (from low to high) and the natural orbitals
in the active space are sorted by natural occupations (from large to small).
This ordering may not be held if point group symmetry is enabled in the
calculation.  When a system has high spatial symmetry and point group symmetry
is enabled, each SCF orbital will be assigned to an irreducible representation
label.  In the MCSCF calculation and the canonicalization, the irreducible
representation label of the orbitals will not be changed.  They are always the
same to the symmetry labels of the input orbitals.  Although the orbitals
are still ordered within each irreducible representation, the orbital energies
(or occupancies) for all orbitals are not strictly sorted.  Setting
<code class="docutils literal"><span class="pre">mc.sorting_mo_energy</span> <span class="pre">=</span> <span class="pre">Trye</span></code> (though not recommended) can force the orbitals
to be sorted regardless whether the point group symmetry is enabled.  In certain
scenario, you may want to enable <code class="xref py py-attr docutils literal"><span class="pre">mc.natorb</span></code> and <code class="xref py py-attr docutils literal"><span class="pre">mc.sorting_mo_energy</span></code>.
<code class="docutils literal"><span class="pre">examples/dmrg/31-cr2_scan/cr2-scan.py</span></code> provides one example that you need to
enable the two parameters.  In that example, the dissociation curve of Cr dimer
was scanned by heat-bath selected-CI method in which the active space of
selected-CI-CASSCF was gradually enlarged in a series of CASSCF calculations.
Since the selected-CI algorithm depends on the initial single determinant, the
orbital ordering do have matters to the final CASSCF results. Thus
<code class="xref py py-attr docutils literal"><span class="pre">mc.natorb</span></code> and <code class="xref py py-attr docutils literal"><span class="pre">mc.sorting_mo_energy</span></code> have to be enabled to make
sure that the each selected-CI starts from the similar initial reference for
each point on the dissociation curve.  At some critical points, the difference
in the orbital ordering in the active space can lead to discontinuous potential
energy curve.</p>
</div>
<div class="section" id="program-reference">
<h2>Program reference<a class="headerlink" href="#program-reference" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyscf.mcscf.casci">
<span id="casci"></span><h3>CASCI<a class="headerlink" href="#module-pyscf.mcscf.casci" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyscf.mcscf.casci.CASCI">
<em class="property">class </em><code class="descclassname">pyscf.mcscf.casci.</code><code class="descname">CASCI</code><span class="sig-paren">(</span><em>mf</em>, <em>ncas</em>, <em>nelecas</em>, <em>ncore=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#CASCI"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Attributes:</dt>
<dd><dl class="first last docutils">
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level.  Default value equals to <code class="xref py py-class docutils literal"><span class="pre">Mole.verbose</span></code>.</dd>
<dt>max_memory</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>Allowed memory in MB.  Default value equals to <code class="xref py py-class docutils literal"><span class="pre">Mole.max_memory</span></code>.</dd>
<dt>ncas</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Active space size.</dd>
<dt>nelecas</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">tuple of int</span><dd>Active (nelec_alpha, nelec_beta)</dd>
<dt>ncore</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int or tuple of int</span><dd>Core electron number.  In UHF-CASSCF, it&#8217;s a tuple to indicate the different core eletron numbers.</dd>
<dt>natorb</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Whether to restore the natural orbital in CAS space.  Default is not.
Be very careful to set this parameter when CASCI/CASSCF are combined
with DMRG solver because this parameter changes the orbital ordering
which DMRG relies on.</dd>
<dt>canonicalization</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Whether to canonicalize orbitals.  Default is True.</dd>
<dt>sorting_mo_energy</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Whether to sort the orbitals based on the diagonal elements of the
general Fock matrix.  Default is False.</dd>
<dt>fcisolver</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">an instance of <code class="xref py py-class docutils literal"><span class="pre">FCISolver</span></code></span><dd><p class="first">The pyscf.fci module provides several FCISolver for different scenario.  Generally,
fci.direct_spin1.FCISolver can be used for all RHF-CASSCF.  However, a proper FCISolver
can provide better performance and better numerical stability.  One can either use
<code class="xref py py-func docutils literal"><span class="pre">fci.solver()</span></code> function to pick the FCISolver by the program or manually assigen
the FCISolver to this attribute, e.g.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">singlet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCISolver</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<p>You can control FCISolver by setting e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">max_cycle</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">7</span>
</pre></div>
</div>
<p class="last">For more details of the parameter for FCISolver, See <code class="xref py py-mod docutils literal"><span class="pre">fci</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="docutils">
<dt>e_tot</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Total MCSCF energy (electronic energy plus nuclear repulsion)</dd>
<dt>ci</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>CAS space FCI coefficients</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-108.980200816243354</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyscf.mcscf.casci.CASCI.canonicalize">
<code class="descname">canonicalize</code><span class="sig-paren">(</span><em>mc</em>, <em>mo_coeff=None</em>, <em>ci=None</em>, <em>eris=None</em>, <em>sort=False</em>, <em>cas_natorb=False</em>, <em>casdm1=None</em>, <em>verbose=3</em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.canonicalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Canonicalize CASCI/CASSCF orbitals</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>mc : a CASSCF/CASCI object or RHF object</dd>
<dt>Returns:</dt>
<dd>A tuple, (natural orbitals, CI coefficients, orbital energies)
The orbital energies are the diagonal terms of general Fock matrix.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyscf.mcscf.casci.CASCI.canonicalize_">
<code class="descname">canonicalize_</code><span class="sig-paren">(</span><em>mo_coeff=None</em>, <em>ci=None</em>, <em>eris=None</em>, <em>sort=False</em>, <em>cas_natorb=False</em>, <em>casdm1=None</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#CASCI.canonicalize_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.canonicalize_" title="Permalink to this definition">¶</a></dt>
<dd><p>Canonicalize CASCI/CASSCF orbitals</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>mc : a CASSCF/CASCI object or RHF object</dd>
<dt>Returns:</dt>
<dd>A tuple, (natural orbitals, CI coefficients, orbital energies)
The orbital energies are the diagonal terms of general Fock matrix.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyscf.mcscf.casci.CASCI.cas_natorb">
<code class="descname">cas_natorb</code><span class="sig-paren">(</span><em>mo_coeff=None</em>, <em>ci=None</em>, <em>eris=None</em>, <em>sort=False</em>, <em>casdm1=None</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#CASCI.cas_natorb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.cas_natorb" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform active orbitals to natrual orbitals, and update the CI wfn</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>mc : a CASSCF/CASCI object or RHF object</dd>
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>sort</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Sort natural orbitals wrt the occupancy.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>A tuple, the first item is natural orbitals, the second is updated CI
coefficients, the third is the natural occupancy associated to the
natural orbitals.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyscf.mcscf.casci.CASCI.cas_natorb_">
<code class="descname">cas_natorb_</code><span class="sig-paren">(</span><em>mo_coeff=None</em>, <em>ci=None</em>, <em>eris=None</em>, <em>sort=False</em>, <em>casdm1=None</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#CASCI.cas_natorb_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.cas_natorb_" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform active orbitals to natrual orbitals, and update the CI wfn</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>mc : a CASSCF/CASCI object or RHF object</dd>
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>sort</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Sort natural orbitals wrt the occupancy.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>A tuple, the first item is natural orbitals, the second is updated CI
coefficients, the third is the natural occupancy associated to the
natural orbitals.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyscf.mcscf.casci.CASCI.fix_spin_">
<code class="descname">fix_spin_</code><span class="sig-paren">(</span><em>shift=0.2</em>, <em>ss=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#CASCI.fix_spin_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.fix_spin_" title="Permalink to this definition">¶</a></dt>
<dd><p>Use level shift to control FCI solver spin.</p>
<div class="math">
\[(H + shift*S^2) |\Psi\rangle = E |\Psi\rangle\]</div>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>shift</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Level shift for states which have different spin</dd>
<dt>ss</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">number</span><dd>S^2 expection value == s*(s+1)</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyscf.mcscf.casci.CASCI.get_h1cas">
<code class="descname">get_h1cas</code><span class="sig-paren">(</span><em>mo_coeff=None</em>, <em>ncas=None</em>, <em>ncore=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#CASCI.get_h1cas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.get_h1cas" title="Permalink to this definition">¶</a></dt>
<dd><p>CAS sapce one-electron hamiltonian</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>casci : a CASSCF/CASCI object or RHF object</dd>
<dt>Returns:</dt>
<dd>A tuple, the first is the effective one-electron hamiltonian defined in CAS space,
the second is the electronic energy from core.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyscf.mcscf.casci.CASCI.get_h1eff">
<code class="descname">get_h1eff</code><span class="sig-paren">(</span><em>mo_coeff=None</em>, <em>ncas=None</em>, <em>ncore=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#CASCI.get_h1eff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.get_h1eff" title="Permalink to this definition">¶</a></dt>
<dd><p>CAS sapce one-electron hamiltonian</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>casci : a CASSCF/CASCI object or RHF object</dd>
<dt>Returns:</dt>
<dd>A tuple, the first is the effective one-electron hamiltonian defined in CAS space,
the second is the electronic energy from core.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyscf.mcscf.casci.CASCI.h1e_for_cas">
<code class="descname">h1e_for_cas</code><span class="sig-paren">(</span><em>mo_coeff=None</em>, <em>ncas=None</em>, <em>ncore=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#CASCI.h1e_for_cas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.h1e_for_cas" title="Permalink to this definition">¶</a></dt>
<dd><p>CAS sapce one-electron hamiltonian</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>casci : a CASSCF/CASCI object or RHF object</dd>
<dt>Returns:</dt>
<dd>A tuple, the first is the effective one-electron hamiltonian defined in CAS space,
the second is the electronic energy from core.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pyscf.mcscf.casci.CASCI.make_rdm1">
<code class="descname">make_rdm1</code><span class="sig-paren">(</span><em>mo_coeff=None</em>, <em>ci=None</em>, <em>ncas=None</em>, <em>nelecas=None</em>, <em>ncore=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#CASCI.make_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>One-particle density matrix in AO representation</p>
</dd></dl>

<dl class="method">
<dt id="pyscf.mcscf.casci.CASCI.make_rdm1s">
<code class="descname">make_rdm1s</code><span class="sig-paren">(</span><em>mo_coeff=None</em>, <em>ci=None</em>, <em>ncas=None</em>, <em>nelecas=None</em>, <em>ncore=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#CASCI.make_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.make_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>One-particle density matrices for alpha and beta spin</p>
</dd></dl>

<dl class="method">
<dt id="pyscf.mcscf.casci.CASCI.sort_mo">
<code class="descname">sort_mo</code><span class="sig-paren">(</span><em>caslst</em>, <em>mo_coeff=None</em>, <em>base=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#CASCI.sort_mo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.sort_mo" title="Permalink to this definition">¶</a></dt>
<dd><p>Select active space.  See also <a class="reference internal" href="#pyscf.mcscf.addons.sort_mo" title="pyscf.mcscf.addons.sort_mo"><code class="xref py py-func docutils literal"><span class="pre">pyscf.mcscf.addons.sort_mo()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="pyscf.mcscf.casci.CASCI.state_average_">
<code class="descname">state_average_</code><span class="sig-paren">(</span><em>weights=(0.5</em>, <em>0.5)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#CASCI.state_average_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.state_average_" title="Permalink to this definition">¶</a></dt>
<dd><p>State average over the energy.  The energy funcitonal is
E = w1&lt;psi1|H|psi1&gt; + w2&lt;psi2|H|psi2&gt; + ...</p>
<p>Note we may need change the FCI solver to</p>
<p>mc.fcisolver = fci.solver(mol, False)</p>
<p>before calling state_average_(mc), to mix the singlet and triplet states</p>
</dd></dl>

<dl class="method">
<dt id="pyscf.mcscf.casci.CASCI.state_specific_">
<code class="descname">state_specific_</code><span class="sig-paren">(</span><em>state=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#CASCI.state_specific_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.CASCI.state_specific_" title="Permalink to this definition">¶</a></dt>
<dd><p>For excited state</p>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>state : int
0 for ground state; 1 for first excited state.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.casci.canonicalize">
<code class="descclassname">pyscf.mcscf.casci.</code><code class="descname">canonicalize</code><span class="sig-paren">(</span><em>mc</em>, <em>mo_coeff=None</em>, <em>ci=None</em>, <em>eris=None</em>, <em>sort=False</em>, <em>cas_natorb=False</em>, <em>casdm1=None</em>, <em>verbose=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#canonicalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.canonicalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Canonicalize CASCI/CASSCF orbitals</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>mc : a CASSCF/CASCI object or RHF object</dd>
<dt>Returns:</dt>
<dd>A tuple, (natural orbitals, CI coefficients, orbital energies)
The orbital energies are the diagonal terms of general Fock matrix.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.casci.cas_natorb">
<code class="descclassname">pyscf.mcscf.casci.</code><code class="descname">cas_natorb</code><span class="sig-paren">(</span><em>mc</em>, <em>mo_coeff=None</em>, <em>ci=None</em>, <em>eris=None</em>, <em>sort=False</em>, <em>casdm1=None</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#cas_natorb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.cas_natorb" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform active orbitals to natrual orbitals, and update the CI wfn</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>mc : a CASSCF/CASCI object or RHF object</dd>
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>sort</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Sort natural orbitals wrt the occupancy.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>A tuple, the first item is natural orbitals, the second is updated CI
coefficients, the third is the natural occupancy associated to the
natural orbitals.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.casci.get_fock">
<code class="descclassname">pyscf.mcscf.casci.</code><code class="descname">get_fock</code><span class="sig-paren">(</span><em>mc</em>, <em>mo_coeff=None</em>, <em>ci=None</em>, <em>eris=None</em>, <em>casdm1=None</em>, <em>verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#get_fock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.get_fock" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalized Fock matrix in AO representation</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.casci.h1e_for_cas">
<code class="descclassname">pyscf.mcscf.casci.</code><code class="descname">h1e_for_cas</code><span class="sig-paren">(</span><em>casci</em>, <em>mo_coeff=None</em>, <em>ncas=None</em>, <em>ncore=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#h1e_for_cas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.h1e_for_cas" title="Permalink to this definition">¶</a></dt>
<dd><p>CAS sapce one-electron hamiltonian</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>casci : a CASSCF/CASCI object or RHF object</dd>
<dt>Returns:</dt>
<dd>A tuple, the first is the effective one-electron hamiltonian defined in CAS space,
the second is the electronic energy from core.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.casci.kernel">
<code class="descclassname">pyscf.mcscf.casci.</code><code class="descname">kernel</code><span class="sig-paren">(</span><em>casci</em>, <em>mo_coeff=None</em>, <em>ci0=None</em>, <em>verbose=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>CASCI solver</p>
</dd></dl>

<span class="target" id="module-pyscf.mcscf.casci_symm"></span><span class="target" id="module-pyscf.mcscf.casci_uhf"></span><dl class="function">
<dt id="pyscf.mcscf.casci_uhf.h1e_for_cas">
<code class="descclassname">pyscf.mcscf.casci_uhf.</code><code class="descname">h1e_for_cas</code><span class="sig-paren">(</span><em>casci</em>, <em>mo_coeff=None</em>, <em>ncas=None</em>, <em>ncore=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci_uhf.html#h1e_for_cas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci_uhf.h1e_for_cas" title="Permalink to this definition">¶</a></dt>
<dd><p>CAS sapce one-electron hamiltonian for UHF-CASCI or UHF-CASSCF</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>casci : a U-CASSCF/U-CASCI object or UHF object</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.casci_uhf.kernel">
<code class="descclassname">pyscf.mcscf.casci_uhf.</code><code class="descname">kernel</code><span class="sig-paren">(</span><em>casci</em>, <em>mo_coeff=None</em>, <em>ci0=None</em>, <em>verbose=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/casci_uhf.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.casci_uhf.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>UHF-CASCI solver</p>
</dd></dl>

</div>
<div class="section" id="module-pyscf.mcscf.mc1step">
<span id="casscf"></span><h3>CASSCF<a class="headerlink" href="#module-pyscf.mcscf.mc1step" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyscf.mcscf.mc1step.CASSCF">
<em class="property">class </em><code class="descclassname">pyscf.mcscf.mc1step.</code><code class="descname">CASSCF</code><span class="sig-paren">(</span><em>mf</em>, <em>ncas</em>, <em>nelecas</em>, <em>ncore=None</em>, <em>frozen=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/mc1step.html#CASSCF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Attributes:</dt>
<dd><dl class="first last docutils">
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level.  Default value equals to <code class="xref py py-class docutils literal"><span class="pre">Mole.verbose</span></code>.</dd>
<dt>max_memory</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>Allowed memory in MB.  Default value equals to <code class="xref py py-class docutils literal"><span class="pre">Mole.max_memory</span></code>.</dd>
<dt>ncas</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Active space size.</dd>
<dt>nelecas</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">tuple of int</span><dd>Active (nelec_alpha, nelec_beta)</dd>
<dt>ncore</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int or tuple of int</span><dd>Core electron number.  In UHF-CASSCF, it&#8217;s a tuple to indicate the different core eletron numbers.</dd>
<dt>natorb</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Whether to restore the natural orbital in CAS space.  Default is not.
Be very careful to set this parameter when CASCI/CASSCF are combined
with DMRG solver because this parameter changes the orbital ordering
which DMRG relies on.</dd>
<dt>canonicalization</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Whether to canonicalize orbitals.  Default is True.</dd>
<dt>sorting_mo_energy</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Whether to sort the orbitals based on the diagonal elements of the
general Fock matrix.  Default is False.</dd>
<dt>fcisolver</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">an instance of <code class="xref py py-class docutils literal"><span class="pre">FCISolver</span></code></span><dd><p class="first">The pyscf.fci module provides several FCISolver for different scenario.  Generally,
fci.direct_spin1.FCISolver can be used for all RHF-CASSCF.  However, a proper FCISolver
can provide better performance and better numerical stability.  One can either use
<code class="xref py py-func docutils literal"><span class="pre">fci.solver()</span></code> function to pick the FCISolver by the program or manually assigen
the FCISolver to this attribute, e.g.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">singlet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCISolver</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<p>You can control FCISolver by setting e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">max_cycle</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">7</span>
</pre></div>
</div>
<p class="last">For more details of the parameter for FCISolver, See <code class="xref py py-mod docutils literal"><span class="pre">fci</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="docutils">
<dt>e_tot</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Total MCSCF energy (electronic energy plus nuclear repulsion)</dd>
<dt>ci</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>CAS space FCI coefficients</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-108.980200816243354</span>
<span class="go">CASSCF</span>
</pre></div>
</div>
<p>Extra attributes for CASSCF:</p>
<blockquote>
<div><dl class="docutils">
<dt>conv_tol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Converge threshold.  Default is 1e-7</dd>
<dt>conv_tol_grad</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Converge threshold for CI gradients and orbital rotation gradients.
Default is 1e-4</dd>
<dt>max_stepsize</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>The step size for orbital rotation.  Small step (0.005 - 0.05) is prefered.
(see notes in max_cycle_micro_inner attribute)
Default is 0.03.</dd>
<dt>max_cycle_macro</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Max number of macro iterations.  Default is 50.</dd>
<dt>max_cycle_micro</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Max number of micro iterations in each macro iteration.  Depending on
systems, increasing this value might reduce the total macro
iterations.  Generally, 2 - 5 steps should be enough.  Default is 3.</dd>
<dt>ah_level_shift</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float, for AH solver.</span><dd>Level shift for the Davidson diagonalization in AH solver.  Default is 1e-8.</dd>
<dt>ah_conv_tol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float, for AH solver.</span><dd>converge threshold for AH solver.  Default is 1e-12.</dd>
<dt>ah_max_cycle</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float, for AH solver.</span><dd>Max number of iterations allowd in AH solver.  Default is 30.</dd>
<dt>ah_lindep</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float, for AH solver.</span><dd>Linear dependence threshold for AH solver.  Default is 1e-14.</dd>
<dt>ah_start_tol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">flat, for AH solver.</span><dd>In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 0.2.</dd>
<dt>ah_start_cycle</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int, for AH solver.</span><dd><p class="first">In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 2.</p>
<p><code class="docutils literal"><span class="pre">ah_conv_tol</span></code>, <code class="docutils literal"><span class="pre">ah_max_cycle</span></code>, <code class="docutils literal"><span class="pre">ah_lindep</span></code>, <code class="docutils literal"><span class="pre">ah_start_tol</span></code> and <code class="docutils literal"><span class="pre">ah_start_cycle</span></code>
can affect the accuracy and performance of CASSCF solver.  Lower
<code class="docutils literal"><span class="pre">ah_conv_tol</span></code> and <code class="docutils literal"><span class="pre">ah_lindep</span></code> might improve the accuracy of CASSCF
optimization, but decrease the performance.</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-109.044401898486001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-109.044401887945668</span>
</pre></div>
</div>
</dd>
<dt>chkfile</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>Checkpoint file to save the intermediate orbitals during the CASSCF optimization.
Default is the checkpoint file of mean field object.</dd>
<dt>ci_response_space</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>subspace size to solve the CI vector response.  Default is 3.</dd>
<dt>callback</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">function(envs_dict) =&gt; None</span><dd>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
envrionment.</dd>
</dl>
</div></blockquote>
<p>Saved results</p>
<blockquote>
<div><dl class="docutils">
<dt>e_tot</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Total MCSCF energy (electronic energy plus nuclear repulsion)</dd>
<dt>ci</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>CAS space FCI coefficients</dd>
<dt>converged</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>It indicates CASSCF optimization converged or not.</dd>
<dt>mo_coeff</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>Optimized CASSCF orbitals coefficients</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.044401882238134</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyscf.mcscf.mc1step.CASSCF.rotate_mo">
<code class="descname">rotate_mo</code><span class="sig-paren">(</span><em>mo</em>, <em>u</em>, <em>log=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/mc1step.html#CASSCF.rotate_mo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.rotate_mo" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate orbitals with the given unitary matrix</p>
</dd></dl>

<dl class="method">
<dt id="pyscf.mcscf.mc1step.CASSCF.solve_approx_ci">
<code class="descname">solve_approx_ci</code><span class="sig-paren">(</span><em>h1</em>, <em>h2</em>, <em>ci0</em>, <em>ecore</em>, <em>e_ci</em>, <em>envs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/mc1step.html#CASSCF.solve_approx_ci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.CASSCF.solve_approx_ci" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve CI eigenvalue/response problem approximately</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.mc1step.kernel">
<code class="descclassname">pyscf.mcscf.mc1step.</code><code class="descname">kernel</code><span class="sig-paren">(</span><em>casscf</em>, <em>mo_coeff</em>, <em>tol=1e-07</em>, <em>conv_tol_grad=None</em>, <em>ci0=None</em>, <em>callback=None</em>, <em>verbose=3</em>, <em>dump_chk=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/mc1step.html#kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.mc1step.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>CASSCF solver</p>
</dd></dl>

<span class="target" id="module-pyscf.mcscf.mc1step_symm"></span><dl class="class">
<dt id="pyscf.mcscf.mc1step_symm.CASSCF">
<em class="property">class </em><code class="descclassname">pyscf.mcscf.mc1step_symm.</code><code class="descname">CASSCF</code><span class="sig-paren">(</span><em>mf</em>, <em>ncas</em>, <em>nelecas</em>, <em>ncore=None</em>, <em>frozen=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/mc1step_symm.html#CASSCF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.mc1step_symm.CASSCF" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Attributes:</dt>
<dd><dl class="first last docutils">
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level.  Default value equals to <code class="xref py py-class docutils literal"><span class="pre">Mole.verbose</span></code>.</dd>
<dt>max_memory</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>Allowed memory in MB.  Default value equals to <code class="xref py py-class docutils literal"><span class="pre">Mole.max_memory</span></code>.</dd>
<dt>ncas</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Active space size.</dd>
<dt>nelecas</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">tuple of int</span><dd>Active (nelec_alpha, nelec_beta)</dd>
<dt>ncore</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int or tuple of int</span><dd>Core electron number.  In UHF-CASSCF, it&#8217;s a tuple to indicate the different core eletron numbers.</dd>
<dt>natorb</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Whether to restore the natural orbital in CAS space.  Default is not.
Be very careful to set this parameter when CASCI/CASSCF are combined
with DMRG solver because this parameter changes the orbital ordering
which DMRG relies on.</dd>
<dt>canonicalization</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Whether to canonicalize orbitals.  Default is True.</dd>
<dt>sorting_mo_energy</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>Whether to sort the orbitals based on the diagonal elements of the
general Fock matrix.  Default is False.</dd>
<dt>fcisolver</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">an instance of <code class="xref py py-class docutils literal"><span class="pre">FCISolver</span></code></span><dd><p class="first">The pyscf.fci module provides several FCISolver for different scenario.  Generally,
fci.direct_spin1.FCISolver can be used for all RHF-CASSCF.  However, a proper FCISolver
can provide better performance and better numerical stability.  One can either use
<code class="xref py py-func docutils literal"><span class="pre">fci.solver()</span></code> function to pick the FCISolver by the program or manually assigen
the FCISolver to this attribute, e.g.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">fci</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">solver</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">singlet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span> <span class="o">=</span> <span class="n">fci</span><span class="o">.</span><span class="n">direct_spin1</span><span class="o">.</span><span class="n">FCISolver</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<p>You can control FCISolver by setting e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">max_cycle</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">fcisolver</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">7</span>
</pre></div>
</div>
<p class="last">For more details of the parameter for FCISolver, See <code class="xref py py-mod docutils literal"><span class="pre">fci</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p>Saved results</p>
<blockquote>
<div><dl class="docutils">
<dt>e_tot</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Total MCSCF energy (electronic energy plus nuclear repulsion)</dd>
<dt>ci</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>CAS space FCI coefficients</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASCI</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-108.980200816243354</span>
<span class="go">CASSCF</span>
</pre></div>
</div>
<p>Extra attributes for CASSCF:</p>
<blockquote>
<div><dl class="docutils">
<dt>conv_tol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Converge threshold.  Default is 1e-7</dd>
<dt>conv_tol_grad</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Converge threshold for CI gradients and orbital rotation gradients.
Default is 1e-4</dd>
<dt>max_stepsize</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>The step size for orbital rotation.  Small step (0.005 - 0.05) is prefered.
(see notes in max_cycle_micro_inner attribute)
Default is 0.03.</dd>
<dt>max_cycle_macro</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Max number of macro iterations.  Default is 50.</dd>
<dt>max_cycle_micro</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Max number of micro iterations in each macro iteration.  Depending on
systems, increasing this value might reduce the total macro
iterations.  Generally, 2 - 5 steps should be enough.  Default is 3.</dd>
<dt>ah_level_shift</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float, for AH solver.</span><dd>Level shift for the Davidson diagonalization in AH solver.  Default is 1e-8.</dd>
<dt>ah_conv_tol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float, for AH solver.</span><dd>converge threshold for AH solver.  Default is 1e-12.</dd>
<dt>ah_max_cycle</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float, for AH solver.</span><dd>Max number of iterations allowd in AH solver.  Default is 30.</dd>
<dt>ah_lindep</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float, for AH solver.</span><dd>Linear dependence threshold for AH solver.  Default is 1e-14.</dd>
<dt>ah_start_tol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">flat, for AH solver.</span><dd>In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 0.2.</dd>
<dt>ah_start_cycle</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int, for AH solver.</span><dd><p class="first">In AH solver, the orbital rotation is started without completely solving the AH problem.
This value is to control the start point. Default is 2.</p>
<p><code class="docutils literal"><span class="pre">ah_conv_tol</span></code>, <code class="docutils literal"><span class="pre">ah_max_cycle</span></code>, <code class="docutils literal"><span class="pre">ah_lindep</span></code>, <code class="docutils literal"><span class="pre">ah_start_tol</span></code> and <code class="docutils literal"><span class="pre">ah_start_cycle</span></code>
can affect the accuracy and performance of CASSCF solver.  Lower
<code class="docutils literal"><span class="pre">ah_conv_tol</span></code> and <code class="docutils literal"><span class="pre">ah_lindep</span></code> might improve the accuracy of CASSCF
optimization, but decrease the performance.</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-109.044401898486001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">ah_conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">-109.044401887945668</span>
</pre></div>
</div>
</dd>
<dt>chkfile</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>Checkpoint file to save the intermediate orbitals during the CASSCF optimization.
Default is the checkpoint file of mean field object.</dd>
<dt>ci_response_space</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>subspace size to solve the CI vector response.  Default is 3.</dd>
<dt>callback</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">function(envs_dict) =&gt; None</span><dd>callback function takes one dict as the argument which is
generated by the builtin function <code class="xref py py-func docutils literal"><span class="pre">locals()</span></code>, so that the
callback function can access all local variables in the current
envrionment.</dd>
</dl>
</div></blockquote>
<p>Saved results</p>
<blockquote>
<div><dl class="docutils">
<dt>e_tot</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float</span><dd>Total MCSCF energy (electronic energy plus nuclear repulsion)</dd>
<dt>ci</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>CAS space FCI coefficients</dd>
<dt>converged</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>It indicates CASSCF optimization converged or not.</dd>
<dt>mo_coeff</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>Optimized CASSCF orbitals coefficients</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.044401882238134</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyscf.mcscf.mc1step_symm.CASSCF.rotate_mo">
<code class="descname">rotate_mo</code><span class="sig-paren">(</span><em>mo</em>, <em>u</em>, <em>log=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/mc1step_symm.html#CASSCF.rotate_mo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.mc1step_symm.CASSCF.rotate_mo" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate orbitals with the given unitary matrix</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-pyscf.mcscf.mc1step_uhf"></span><span class="target" id="module-pyscf.mcscf.mc_ao2mo"></span><span class="target" id="module-pyscf.mcscf.mc_ao2mo_uhf"></span></div>
<div class="section" id="module-pyscf.mcscf.addons">
<span id="addons"></span><h3>addons<a class="headerlink" href="#module-pyscf.mcscf.addons" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="pyscf.mcscf.addons.cas_natorb">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">cas_natorb</code><span class="sig-paren">(</span><em>casscf</em>, <em>mo_coeff=None</em>, <em>ci=None</em>, <em>sort=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#cas_natorb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.cas_natorb" title="Permalink to this definition">¶</a></dt>
<dd><p>Natrual orbitals in CAS space</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.caslst_by_irrep">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">caslst_by_irrep</code><span class="sig-paren">(</span><em>casscf</em>, <em>mo_coeff</em>, <em>cas_irrep_nocc</em>, <em>cas_irrep_ncore=None</em>, <em>s=None</em>, <em>base=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#caslst_by_irrep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.caslst_by_irrep" title="Permalink to this definition">¶</a></dt>
<dd><p>Given number of active orbitals for each irrep, return the orbital
indices of active space</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">casscf : an <code class="xref py py-class docutils literal"><span class="pre">CASSCF</span></code> or <code class="xref py py-class docutils literal"><span class="pre">CASCI</span></code> object</p>
<dl class="last docutils">
<dt>cas_irrep_nocc</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">list or dict</span><dd>Number of active orbitals for each irrep.  It can be a dict, eg
{&#8216;A1&#8217;: 2, &#8216;B2&#8217;: 4} to indicate the active space size based on
irrep names, or {0: 2, 3: 4} for irrep Id,  or a list [2, 0, 0, 4]
(identical to {0: 2, 3: 4}) in which the list index is served as
the irrep Id.</dd>
</dl>
</dd>
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>cas_irrep_ncore</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">list or dict</span><dd>Number of closed shells for each irrep.  It can be a dict, eg
{&#8216;A1&#8217;: 6, &#8216;B2&#8217;: 4} to indicate the closed shells based on
irrep names, or {0: 6, 3: 4} for irrep Id,  or a list [6, 0, 0, 4]
(identical to {0: 6, 3: 4}) in which the list index is served as
the irrep Id.  If cas_irrep_ncore is not given, the program
will generate a guess based on the lowest <code class="xref py py-attr docutils literal"><span class="pre">CASCI.ncore</span></code>
orbitals.</dd>
<dt>s</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>overlap matrix</dd>
<dt>base</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>0-based (C-like) or 1-based (Fortran-like) caslst</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>A list of orbital indices</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvtz&#39;</span><span class="p">,</span> <span class="n">symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcscf</span><span class="o">.</span><span class="n">caslst_by_irrep</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;E1gx&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;E1gy&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;E1ux&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;E1uy&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="go">[5, 7, 8, 10, 11, 14, 15, 20, 25, 26, 31, 32]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.get_fock">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">get_fock</code><span class="sig-paren">(</span><em>casscf</em>, <em>mo_coeff=None</em>, <em>ci=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#get_fock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.get_fock" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalized Fock matrix in AO representation</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.hot_tuning_">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">hot_tuning_</code><span class="sig-paren">(</span><em>casscf</em>, <em>configfile=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#hot_tuning_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.hot_tuning_" title="Permalink to this definition">¶</a></dt>
<dd><p>Allow you to tune CASSCF parameters at the runtime</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.make_rdm1">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">make_rdm1</code><span class="sig-paren">(</span><em>casscf</em>, <em>mo_coeff=None</em>, <em>ci=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#make_rdm1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.make_rdm1" title="Permalink to this definition">¶</a></dt>
<dd><p>One-particle densit matrix in AO representation</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>casscf : an <code class="xref py py-class docutils literal"><span class="pre">CASSCF</span></code> or <code class="xref py py-class docutils literal"><span class="pre">CASCI</span></code> object</dd>
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>ci</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>CAS space FCI coefficients. If not given, take casscf.ci.</dd>
<dt>mo_coeff</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>Orbital coefficients. If not given, take casscf.mo_coeff.</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.linalg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto-3g&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">natocc</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">mcscf</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">(</span><span class="n">mc</span><span class="p">),</span> <span class="n">mf</span><span class="o">.</span><span class="n">get_ovlp</span><span class="p">(),</span> <span class="nb">type</span><span class="o">=</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">natocc</span><span class="p">)</span>
<span class="go">[ 0.0121563   0.0494735   0.0494735   1.95040395  1.95040395  1.98808879</span>
<span class="go">  2.          2.          2.          2.        ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.make_rdm1s">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">make_rdm1s</code><span class="sig-paren">(</span><em>casscf</em>, <em>mo_coeff=None</em>, <em>ci=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#make_rdm1s"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.make_rdm1s" title="Permalink to this definition">¶</a></dt>
<dd><p>Alpha and beta one-particle densit matrices in AO representation</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.map2hf">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">map2hf</code><span class="sig-paren">(</span><em>casscf</em>, <em>mf_mo=None</em>, <em>base=1</em>, <em>tol=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#map2hf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.map2hf" title="Permalink to this definition">¶</a></dt>
<dd><p>The overlap between the CASSCF optimized orbitals and the canonical HF orbitals.</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.project_init_guess">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">project_init_guess</code><span class="sig-paren">(</span><em>casscf</em>, <em>init_mo</em>, <em>prev_mol=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#project_init_guess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.project_init_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Project the given initial guess to the current CASSCF problem.  The
projected initial guess has two parts.  The core orbitals are directly
taken from the Hartree-Fock orbitals, and the active orbitals are
projected from the given initial guess.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">casscf : an <code class="xref py py-class docutils literal"><span class="pre">CASSCF</span></code> or <code class="xref py py-class docutils literal"><span class="pre">CASCI</span></code> object</p>
<dl class="last docutils">
<dt>init_mo</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray or list of ndarray</span><dd>Initial guess orbitals which are not orth-normal for the current
molecule.  When the casscf is UHF-CASSCF, the init_mo needs to be
a list of two ndarrays, for alpha and beta orbitals</dd>
</dl>
</dd>
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>prev_mol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">an instance of <code class="xref py py-class docutils literal"><span class="pre">Mole</span></code></span><dd>If given, the inital guess orbitals are associated to the geometry
and basis of prev_mol.  Otherwise, the orbitals are based of
the geometry and basis of casscf.mol</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>New orthogonal initial guess orbitals with the core taken from
Hartree-Fock orbitals and projected active space from original initial
guess orbitals</dd>
</dl>
<p>Examples:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 0.8&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">mo</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">sort_mo</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;E(0.8) = </span><span class="si">%.12f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mo</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">init_mo</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mo_coeff</span>
<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">mol</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="p">)]]</span>
    <span class="n">mol</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
    <span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
    <span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">mo</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">project_init_guess</span><span class="p">(</span><span class="n">mc</span><span class="p">,</span> <span class="n">init_mo</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;E(</span><span class="si">%2.1f</span><span class="s1">) = </span><span class="si">%.12f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mo</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">init_mo</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">mo_coeff</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.sort_mo">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">sort_mo</code><span class="sig-paren">(</span><em>casscf</em>, <em>mo_coeff</em>, <em>caslst</em>, <em>base=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#sort_mo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.sort_mo" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick orbitals for CAS space</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">casscf : an <code class="xref py py-class docutils literal"><span class="pre">CASSCF</span></code> or <code class="xref py py-class docutils literal"><span class="pre">CASCI</span></code> object</p>
<dl class="last docutils">
<dt>mo_coeff</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray or a list of ndarray</span><dd>Orbitals for CASSCF initial guess.  In the UHF-CASSCF, it&#8217;s a list
of two orbitals, for alpha and beta spin.</dd>
<dt>caslst</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">list of int or nested list of int</span><dd>A list of orbital indices to represent the CAS space.  In the UHF-CASSCF,
it&#8217;s consist of two lists, for alpha and beta spin.</dd>
</dl>
</dd>
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>base</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>0-based (C-style) or 1-based (Fortran-style) caslst</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>An reoreded mo_coeff, which put the orbitals given by caslst in the CAS space</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvdz&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cas_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span> <span class="c1"># pi orbitals</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">sort_mo</span><span class="p">(</span><span class="n">cas_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mo</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-109.007378939813691</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.sort_mo_by_irrep">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">sort_mo_by_irrep</code><span class="sig-paren">(</span><em>casscf</em>, <em>mo_coeff</em>, <em>cas_irrep_nocc</em>, <em>cas_irrep_ncore=None</em>, <em>s=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#sort_mo_by_irrep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.sort_mo_by_irrep" title="Permalink to this definition">¶</a></dt>
<dd><p>Given number of active orbitals for each irrep, construct the mo initial
guess for CASSCF</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><p class="first">casscf : an <code class="xref py py-class docutils literal"><span class="pre">CASSCF</span></code> or <code class="xref py py-class docutils literal"><span class="pre">CASCI</span></code> object</p>
<dl class="last docutils">
<dt>cas_irrep_nocc</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">list or dict</span><dd>Number of active orbitals for each irrep.  It can be a dict, eg
{&#8216;A1&#8217;: 2, &#8216;B2&#8217;: 4} to indicate the active space size based on
irrep names, or {0: 2, 3: 4} for irrep Id,  or a list [2, 0, 0, 4]
(identical to {0: 2, 3: 4}) in which the list index is served as
the irrep Id.</dd>
</dl>
</dd>
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>cas_irrep_ncore</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">list or dict</span><dd>Number of closed shells for each irrep.  It can be a dict, eg
{&#8216;A1&#8217;: 6, &#8216;B2&#8217;: 4} to indicate the closed shells based on
irrep names, or {0: 6, 3: 4} for irrep Id,  or a list [6, 0, 0, 4]
(identical to {0: 6, 3: 4}) in which the list index is served as
the irrep Id.  If cas_irrep_ncore is not given, the program
will generate a guess based on the lowest <code class="xref py py-attr docutils literal"><span class="pre">CASCI.ncore</span></code>
orbitals.</dd>
<dt>s</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>overlap matrix</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>sorted orbitals, ordered as [c,..,c,a,..,a,v,..,v]</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;N 0 0 0; N 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvtz&#39;</span><span class="p">,</span> <span class="n">symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">sort_mo_by_irrep</span><span class="p">({</span><span class="s1">&#39;E1gx&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;E1gy&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;E1ux&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;E1uy&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Same to mo = sort_mo_by_irrep(mc, mf.mo_coeff, {2: 4, 3: 4, 6: 2, 7: 2})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Same to mo = sort_mo_by_irrep(mc, mf.mo_coeff, [0, 0, 4, 4, 0, 0, 2, 2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mo</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">-108.162863845084</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.spin_square">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">spin_square</code><span class="sig-paren">(</span><em>casscf</em>, <em>mo_coeff=None</em>, <em>ci=None</em>, <em>ovlp=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#spin_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.spin_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Spin square of the UHF-CASSCF wavefunction</p>
<dl class="docutils">
<dt>Returns:</dt>
<dd>A list of two floats.  The first is the expectation value of S^2.
The second is the corresponding 2S+1</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; O 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto-3g&#39;</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">UHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">mf</span><span class="o">.</span><span class="n">scf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;S^2 = </span><span class="si">%.7f</span><span class="s1">, 2S+1 = </span><span class="si">%.7f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">spin_square</span><span class="p">(</span><span class="n">mc</span><span class="p">))</span>
<span class="go">S^2 = 3.9831589, 2S+1 = 4.1149284</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.state_average">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">state_average</code><span class="sig-paren">(</span><em>casscf</em>, <em>weights=(0.5</em>, <em>0.5)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.addons.state_average" title="Permalink to this definition">¶</a></dt>
<dd><p>State average over the energy.  The energy funcitonal is
E = w1&lt;psi1|H|psi1&gt; + w2&lt;psi2|H|psi2&gt; + ...</p>
<p>Note we may need change the FCI solver to</p>
<p>mc.fcisolver = fci.solver(mol, False)</p>
<p>before calling state_average_(mc), to mix the singlet and triplet states</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.state_average_">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">state_average_</code><span class="sig-paren">(</span><em>casscf</em>, <em>weights=(0.5</em>, <em>0.5)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#state_average_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.state_average_" title="Permalink to this definition">¶</a></dt>
<dd><p>State average over the energy.  The energy funcitonal is
E = w1&lt;psi1|H|psi1&gt; + w2&lt;psi2|H|psi2&gt; + ...</p>
<p>Note we may need change the FCI solver to</p>
<p>mc.fcisolver = fci.solver(mol, False)</p>
<p>before calling state_average_(mc), to mix the singlet and triplet states</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.state_average_mix">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">state_average_mix</code><span class="sig-paren">(</span><em>casscf</em>, <em>fcisolvers</em>, <em>weights=(0.5</em>, <em>0.5)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.addons.state_average_mix" title="Permalink to this definition">¶</a></dt>
<dd><p>State-average CASSCF over multiple FCI solvers.</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.state_average_mix_">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">state_average_mix_</code><span class="sig-paren">(</span><em>casscf</em>, <em>fcisolvers</em>, <em>weights=(0.5</em>, <em>0.5)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#state_average_mix_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.state_average_mix_" title="Permalink to this definition">¶</a></dt>
<dd><p>State-average CASSCF over multiple FCI solvers.</p>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.state_specific">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">state_specific</code><span class="sig-paren">(</span><em>casscf</em>, <em>state=1</em><span class="sig-paren">)</span><a class="headerlink" href="#pyscf.mcscf.addons.state_specific" title="Permalink to this definition">¶</a></dt>
<dd><p>For excited state</p>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>state : int
0 for ground state; 1 for first excited state.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyscf.mcscf.addons.state_specific_">
<code class="descclassname">pyscf.mcscf.addons.</code><code class="descname">state_specific_</code><span class="sig-paren">(</span><em>casscf</em>, <em>state=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/mcscf/addons.html#state_specific_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.mcscf.addons.state_specific_" title="Permalink to this definition">¶</a></dt>
<dd><p>For excited state</p>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>state : int
0 for ground state; 1 for first excited state.</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="fci.html" class="btn btn-neutral float-right" title="fci — Full configuration interaction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ao2mo.html" class="btn btn-neutral" title="ao2mo — Integral transformations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-, Qiming Sun &lt;osirpt.sun@gmail.com&gt;.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.4.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: ''
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>