

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ao2mo — Integral transformations &mdash; PySCF 1.4.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PySCF 1.4.0 documentation" href="index.html"/>
        <link rel="next" title="mcscf — Multi-configurational self-consistent field" href="mcscf.html"/>
        <link rel="prev" title="scf — Mean-field methods" href="scf.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> PySCF
          

          
          </a>

          
            
            
              <div class="version">
                1.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">An overview of PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="gto.html">gto &#8212; Molecular structure and GTO basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="lib.html">lib &#8212; Helper functions, parameters, and C functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="scf.html">scf &#8212; Mean-field methods</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ao2mo &#8212; Integral transformations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-integral-transformation-module">General Integral transformation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyscf.ao2mo.incore">incore</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyscf.ao2mo.outcore">outcore</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyscf.ao2mo.addons">addons</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mcscf.html">mcscf &#8212; Multi-configurational self-consistent field</a></li>
<li class="toctree-l1"><a class="reference internal" href="fci.html">fci &#8212; Full configuration interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="symm.html">symm &#8211; Point group symmetry and spin symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="df.html">df &#8212; Density fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="dft.html">dft &#8212; Density functional theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="tddft.html">tddft &#8212; Time dependent density functional theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="cc.html">cc &#8212; Coupled cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="ci.html">ci &#8212; Configuration interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dmrgscf.html">dmrgscf</a></li>
<li class="toctree-l1"><a class="reference internal" href="fciqmcscf.html">fciqmcscf</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="grad.html">grad &#8212; Analytical nuclear gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="hessian.html">hessian &#8212; Analytical nuclear Hessian</a></li>
<li class="toctree-l1"><a class="reference internal" href="pbc.html">pbc &#8212; Periodic boundary conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="lo.html">lo &#8212; Orbital localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="qmmm.html">qmmm &#8212; QM/MM interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrpt.html">mrpt &#8212; Multi-reference perturbation theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="code-rule.html">Code standard</a></li>
<li class="toctree-l1"><a class="reference internal" href="version.html">Version history</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PySCF</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>ao2mo &#8212; Integral transformations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/ao2mo.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pyscf.ao2mo">
<span id="ao2mo-integral-transformations"></span><h1>ao2mo &#8212; Integral transformations<a class="headerlink" href="#module-pyscf.ao2mo" title="Permalink to this headline">¶</a></h1>
<div class="section" id="general-integral-transformation-module">
<h2>General Integral transformation module<a class="headerlink" href="#general-integral-transformation-module" title="Permalink to this headline">¶</a></h2>
<p>Simple usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; F 0 0 1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo_ints</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="module-pyscf.ao2mo.incore">
<span id="incore"></span><h2>incore<a class="headerlink" href="#module-pyscf.ao2mo.incore" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyscf.ao2mo.incore.full">
<code class="descclassname">pyscf.ao2mo.incore.</code><code class="descname">full</code><span class="sig-paren">(</span><em>eri_ao</em>, <em>mo_coeff</em>, <em>verbose=0</em>, <em>compact=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/ao2mo/incore.html#full"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.ao2mo.incore.full" title="Permalink to this definition">¶</a></dt>
<dd><p>MO integral transformation for the given orbital.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>eri_ao</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>AO integrals, can be either 8-fold or 4-fold symmetry.</dd>
<dt>mo_coeff</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>Transform (ij|kl) with the same set of orbitals.</dd>
</dl>
</dd>
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level</dd>
<dt>compact</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>When compact is True, the returned MO integrals have 4-fold
symmetry.  Otherwise, return the &#8220;plain&#8221; MO integrals.</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>2D array of transformed MO integrals.  The MO integrals may or may not
have the permutation symmetry (controlled by the kwargs compact)</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.scf</span> <span class="k">import</span> <span class="n">_vhf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int2e_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="n">mo1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 55)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100, 100)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyscf.ao2mo.incore.general">
<code class="descclassname">pyscf.ao2mo.incore.</code><code class="descname">general</code><span class="sig-paren">(</span><em>eri_ao</em>, <em>mo_coeffs</em>, <em>verbose=0</em>, <em>compact=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/ao2mo/incore.html#general"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.ao2mo.incore.general" title="Permalink to this definition">¶</a></dt>
<dd><p>For the given four sets of orbitals, transfer the 8-fold or 4-fold 2e
AO integrals to MO integrals.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>eri_ao</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>AO integrals, can be either 8-fold or 4-fold symmetry.</dd>
<dt>mo_coeffs</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">4-item list of ndarray</span><dd>Four sets of orbital coefficients, corresponding to the four
indices of (ij|kl)</dd>
</dl>
</dd>
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level</dd>
<dt>compact</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>When compact is True, depending on the four oribital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it&#8217;s False, the function will abandon any permutation symmetry,
and return the &#8220;plain&#8221; MO integrals</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>2D array of transformed MO integrals.  The MO integrals may or may not
have the permutation symmetry, depending on the given orbitals, and
the kwargs compact.  If the four sets of orbitals are identical, the
MO integrals will at most have 4-fold symmetry.</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.scf</span> <span class="k">import</span> <span class="n">_vhf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int2e_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo3</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 24)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 21)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 36)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 36)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 80)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyscf.ao2mo.incore.half_e1">
<code class="descclassname">pyscf.ao2mo.incore.</code><code class="descname">half_e1</code><span class="sig-paren">(</span><em>eri_ao</em>, <em>mo_coeffs</em>, <em>compact=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/ao2mo/incore.html#half_e1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.ao2mo.incore.half_e1" title="Permalink to this definition">¶</a></dt>
<dd><p>Given two set of orbitals, half transform the (ij| pair of 8-fold or
4-fold AO integrals (ij|kl)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>eri_ao</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>AO integrals, can be either 8-fold or 4-fold symmetry.</dd>
<dt>mo_coeffs</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">list of ndarray</span><dd>Two sets of orbital coefficients, corresponding to the i, j
indices of (ij|kl)</dd>
</dl>
</dd>
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>compact</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>When compact is True, the returned MO integrals uses the highest
possible permutation symmetry.  If it&#8217;s False, the function will
abandon any permutation symmetry, and return the &#8220;plain&#8221; MO
integrals</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>ndarray of transformed MO integrals.  The MO integrals may or may not
have the permutation symmetry, depending on the given orbitals, and
the kwargs compact.</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int2e_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">half_e1</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">half_e1</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 28)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">half_e1</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">),</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 28)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">incore</span><span class="o">.</span><span class="n">half_e1</span><span class="p">(</span><span class="n">eri</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 28)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyscf.ao2mo.outcore">
<span id="outcore"></span><h2>outcore<a class="headerlink" href="#module-pyscf.ao2mo.outcore" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyscf.ao2mo.outcore.full">
<code class="descclassname">pyscf.ao2mo.outcore.</code><code class="descname">full</code><span class="sig-paren">(</span><em>mol</em>, <em>mo_coeff</em>, <em>erifile</em>, <em>dataname='eri_mo'</em>, <em>tmpdir=None</em>, <em>intor='int2e_sph'</em>, <em>aosym='s4'</em>, <em>comp=1</em>, <em>max_memory=2000</em>, <em>ioblk_size=256</em>, <em>verbose=2</em>, <em>compact=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/ao2mo/outcore.html#full"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.full" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfer arbitrary spherical AO integrals to MO integrals for given orbitals</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>mol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal"><span class="pre">Mole</span></code> object</span><dd>AO integrals will be generated in terms of mol._atm, mol._bas, mol._env</dd>
<dt>mo_coeff</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>Transform (ij|kl) with the same set of orbitals.</dd>
<dt>erifile</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str or h5py File or h5py Group object</span><dd>To store the transformed integrals, in HDF5 format.</dd>
</dl>
</dd>
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>dataname</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>The dataset name in the erifile (ref the hierarchy of HDF5 format
<a class="reference external" href="http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html">http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html</a>).  By assigning
different dataname, the existed integral file can be reused.  If
the erifile contains the dataname, the new integrals data will
overwrite the old one.</dd>
<dt>tmpdir</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>The directory where to temporarily store the intermediate data
(the half-transformed integrals).  By default, it&#8217;s controlled by
shell environment variable <code class="docutils literal"><span class="pre">TMPDIR</span></code>.  The disk space requirement
is about  comp*mo_coeffs[0].shape[1]*mo_coeffs[1].shape[1]*nao**2</dd>
<dt>intor</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</dd>
<dt>aosym</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int or str</span><dd><p class="first">Permutation symmetry for the AO integrals</p>
<div class="last line-block">
<div class="line">4 or &#8216;4&#8217; or &#8216;s4&#8217;: 4-fold symmetry (default)</div>
<div class="line">&#8216;2ij&#8217; or &#8216;s2ij&#8217; : symmetry between i, j in (ij|kl)</div>
<div class="line">&#8216;2kl&#8217; or &#8216;s2kl&#8217; : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or &#8216;1&#8217; or &#8216;s1&#8217;: no symmetry</div>
<div class="line">&#8216;a4ij&#8217; : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">&#8216;a4kl&#8217; : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">&#8216;a2ij&#8217; : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">&#8216;a2kl&#8217; : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Components of the integrals, e.g. int2e_ip_sph has 3 components.</dd>
<dt>max_memory</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>The maximum size of cache to use (in MB), large cache may <strong>not</strong>
improve performance.</dd>
<dt>ioblk_size</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>The block size for IO, large block size may <strong>not</strong> improve performance</dd>
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level</dd>
<dt>compact</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>When compact is True, depending on the four oribital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it&#8217;s False, the function will abandon any permutation symmetry,
and return the &#8220;plain&#8221; MO integrals</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>None</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;eri_mo&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">f5</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5file</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset </span><span class="si">%s</span><span class="s1">, shape </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="p">[</span><span class="n">dataname</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="n">f5</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (55, 55)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (100, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="s1">&#39;full.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;full.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 55)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyscf.ao2mo.outcore.full_iofree">
<code class="descclassname">pyscf.ao2mo.outcore.</code><code class="descname">full_iofree</code><span class="sig-paren">(</span><em>mol</em>, <em>mo_coeff</em>, <em>intor='int2e_sph'</em>, <em>aosym='s4'</em>, <em>comp=1</em>, <em>max_memory=2000</em>, <em>ioblk_size=256</em>, <em>verbose=2</em>, <em>compact=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/ao2mo/outcore.html#full_iofree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.full_iofree" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfer arbitrary spherical AO integrals to MO integrals for given orbitals
This function is a wrap for <code class="xref py py-func docutils literal"><span class="pre">ao2mo.outcore.general()</span></code>.  It&#8217;s not really
IO free.  The returned MO integrals are held in memory.  For backward compatibility,
it is used to replace the non-existed function direct.full_iofree.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>mol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal"><span class="pre">Mole</span></code> object</span><dd>AO integrals will be generated in terms of mol._atm, mol._bas, mol._env</dd>
<dt>mo_coeff</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>Transform (ij|kl) with the same set of orbitals.</dd>
<dt>erifile</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>To store the transformed integrals, in HDF5 format.</dd>
</dl>
</dd>
<dt>Kwargs</dt>
<dd><dl class="first last docutils">
<dt>dataname</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>The dataset name in the erifile (ref the hierarchy of HDF5 format
<a class="reference external" href="http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html">http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html</a>).  By assigning
different dataname, the existed integral file can be reused.  If
the erifile contains the dataname, the new integrals data will
overwrite the old one.</dd>
<dt>tmpdir</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>The directory where to temporarily store the intermediate data
(the half-transformed integrals).  By default, it&#8217;s controlled by
shell environment variable <code class="docutils literal"><span class="pre">TMPDIR</span></code>.  The disk space requirement
is about  comp*mo_coeffs[0].shape[1]*mo_coeffs[1].shape[1]*nao**2</dd>
<dt>intor</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</dd>
<dt>aosym</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int or str</span><dd><p class="first">Permutation symmetry for the AO integrals</p>
<div class="last line-block">
<div class="line">4 or &#8216;4&#8217; or &#8216;s4&#8217;: 4-fold symmetry (default)</div>
<div class="line">&#8216;2ij&#8217; or &#8216;s2ij&#8217; : symmetry between i, j in (ij|kl)</div>
<div class="line">&#8216;2kl&#8217; or &#8216;s2kl&#8217; : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or &#8216;1&#8217; or &#8216;s1&#8217;: no symmetry</div>
<div class="line">&#8216;a4ij&#8217; : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">&#8216;a4kl&#8217; : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">&#8216;a2ij&#8217; : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">&#8216;a2kl&#8217; : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Components of the integrals, e.g. int2e_ip_sph has 3 components.</dd>
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level</dd>
<dt>max_memory</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>The maximum size of cache to use (in MB), large cache may <strong>not</strong>
improve performance.</dd>
<dt>ioblk_size</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>The block size for IO, large block size may <strong>not</strong> improve performance</dd>
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level</dd>
<dt>compact</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>When compact is True, depending on the four oribital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it&#8217;s False, the function will abandon any permutation symmetry,
and return the &#8220;plain&#8221; MO integrals</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>2D/3D MO-integral array.  They may or may not have the permutation
symmetry, depending on the given orbitals, and the kwargs compact.  If
the four sets of orbitals are identical, the MO integrals will at most
have 4-fold symmetry.</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(55, 55)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3, 100, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">full_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3, 100, 55)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyscf.ao2mo.outcore.general">
<code class="descclassname">pyscf.ao2mo.outcore.</code><code class="descname">general</code><span class="sig-paren">(</span><em>mol</em>, <em>mo_coeffs</em>, <em>erifile</em>, <em>dataname='eri_mo'</em>, <em>tmpdir=None</em>, <em>intor='int2e_sph'</em>, <em>aosym='s4'</em>, <em>comp=1</em>, <em>max_memory=2000</em>, <em>ioblk_size=256</em>, <em>verbose=2</em>, <em>compact=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/ao2mo/outcore.html#general"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.general" title="Permalink to this definition">¶</a></dt>
<dd><p>For the given four sets of orbitals, transfer arbitrary spherical AO
integrals to MO integrals on the fly.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>mol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal"><span class="pre">Mole</span></code> object</span><dd>AO integrals will be generated in terms of mol._atm, mol._bas, mol._env</dd>
<dt>mo_coeffs</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">4-item list of ndarray</span><dd>Four sets of orbital coefficients, corresponding to the four
indices of (ij|kl)</dd>
<dt>erifile</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str or h5py File or h5py Group object</span><dd>To store the transformed integrals, in HDF5 format.</dd>
</dl>
</dd>
<dt>Kwargs</dt>
<dd><dl class="first last docutils">
<dt>dataname</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>The dataset name in the erifile (ref the hierarchy of HDF5 format
<a class="reference external" href="http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html">http://www.hdfgroup.org/HDF5/doc1.6/UG/09_Groups.html</a>).  By assigning
different dataname, the existed integral file can be reused.  If
the erifile contains the dataname, the new integrals data will
overwrite the old one.</dd>
<dt>tmpdir</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>The directory where to temporarily store the intermediate data
(the half-transformed integrals).  By default, it&#8217;s controlled by
shell environment variable <code class="docutils literal"><span class="pre">TMPDIR</span></code>.  The disk space requirement
is about  comp*mo_coeffs[0].shape[1]*mo_coeffs[1].shape[1]*nao**2</dd>
<dt>intor</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</dd>
<dt>aosym</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int or str</span><dd><p class="first">Permutation symmetry for the AO integrals</p>
<div class="last line-block">
<div class="line">4 or &#8216;4&#8217; or &#8216;s4&#8217;: 4-fold symmetry (default)</div>
<div class="line">&#8216;2ij&#8217; or &#8216;s2ij&#8217; : symmetry between i, j in (ij|kl)</div>
<div class="line">&#8216;2kl&#8217; or &#8216;s2kl&#8217; : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or &#8216;1&#8217; or &#8216;s1&#8217;: no symmetry</div>
<div class="line">&#8216;a4ij&#8217; : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">&#8216;a4kl&#8217; : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">&#8216;a2ij&#8217; : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">&#8216;a2kl&#8217; : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Components of the integrals, e.g. int2e_ip_sph has 3 components.</dd>
<dt>max_memory</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>The maximum size of cache to use (in MB), large cache may <strong>not</strong>
improve performance.</dd>
<dt>ioblk_size</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>The block size for IO, large block size may <strong>not</strong> improve performance</dd>
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level</dd>
<dt>compact</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>When compact is True, depending on the four oribital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it&#8217;s False, the function will abandon any permutation symmetry,
and return the &#8220;plain&#8221; MO integrals</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>None</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;eri_mo&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">f5</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5file</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset </span><span class="si">%s</span><span class="s1">, shape </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="p">[</span><span class="n">dataname</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="n">f5</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo3</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo4</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 24)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 21)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (80, 36)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo2</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;], shape (55, 36)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (55, 55)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="s1">&#39;oh2.h5&#39;</span><span class="p">,</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">view</span><span class="p">(</span><span class="s1">&#39;oh2.h5&#39;</span><span class="p">)</span>
<span class="go">dataset [&#39;eri_mo&#39;, &#39;new&#39;], shape (3, 100, 55)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyscf.ao2mo.outcore.general_iofree">
<code class="descclassname">pyscf.ao2mo.outcore.</code><code class="descname">general_iofree</code><span class="sig-paren">(</span><em>mol</em>, <em>mo_coeffs</em>, <em>intor='int2e_sph'</em>, <em>aosym='s4'</em>, <em>comp=1</em>, <em>max_memory=2000</em>, <em>ioblk_size=256</em>, <em>verbose=2</em>, <em>compact=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/ao2mo/outcore.html#general_iofree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.general_iofree" title="Permalink to this definition">¶</a></dt>
<dd><p>For the given four sets of orbitals, transfer arbitrary spherical AO
integrals to MO integrals on the fly.  This function is a wrap for
<code class="xref py py-func docutils literal"><span class="pre">ao2mo.outcore.general()</span></code>.  It&#8217;s not really IO free.  The returned MO
integrals are held in memory.  For backward compatibility, it is used to
replace the non-existed function direct.general_iofree.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>mol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal"><span class="pre">Mole</span></code> object</span><dd>AO integrals will be generated in terms of mol._atm, mol._bas, mol._env</dd>
<dt>mo_coeffs</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">4-item list of ndarray</span><dd>Four sets of orbital coefficients, corresponding to the four
indices of (ij|kl)</dd>
</dl>
</dd>
<dt>Kwargs</dt>
<dd><dl class="first last docutils">
<dt>intor</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</dd>
<dt>aosym</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int or str</span><dd><p class="first">Permutation symmetry for the AO integrals</p>
<div class="last line-block">
<div class="line">4 or &#8216;4&#8217; or &#8216;s4&#8217;: 4-fold symmetry (default)</div>
<div class="line">&#8216;2ij&#8217; or &#8216;s2ij&#8217; : symmetry between i, j in (ij|kl)</div>
<div class="line">&#8216;2kl&#8217; or &#8216;s2kl&#8217; : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or &#8216;1&#8217; or &#8216;s1&#8217;: no symmetry</div>
<div class="line">&#8216;a4ij&#8217; : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">&#8216;a4kl&#8217; : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">&#8216;a2ij&#8217; : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">&#8216;a2kl&#8217; : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Components of the integrals, e.g. int2e_ip_sph has 3 components.</dd>
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level</dd>
<dt>compact</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>When compact is True, depending on the four oribital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it&#8217;s False, the function will abandon any permutation symmetry,
and return the &#8220;plain&#8221; MO integrals</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>2D/3D MO-integral array.  They may or may not have the permutation
symmetry, depending on the given orbitals, and the kwargs compact.  If
the four sets of orbitals are identical, the MO integrals will at most
have 4-fold symmetry.</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="n">h5file</span><span class="p">,</span> <span class="n">dataname</span><span class="o">=</span><span class="s1">&#39;eri_mo&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">f5</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5file</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset </span><span class="si">%s</span><span class="s1">, shape </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="n">f5</span><span class="p">[</span><span class="n">dataname</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="n">f5</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo1</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo3</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mo4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">(),</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 24)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 21)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo2</span><span class="p">,</span><span class="n">mo3</span><span class="p">,</span><span class="n">mo3</span><span class="p">),</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(80, 36)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3, 100, 100)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">outcore</span><span class="o">.</span><span class="n">general_iofree</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="p">(</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">,</span><span class="n">mo1</span><span class="p">),</span> <span class="n">intor</span><span class="o">=</span><span class="s1">&#39;int2e_ip1_sph&#39;</span><span class="p">,</span> <span class="n">aosym</span><span class="o">=</span><span class="s1">&#39;s2kl&#39;</span><span class="p">,</span> <span class="n">comp</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3, 100, 55)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyscf.ao2mo.outcore.half_e1">
<code class="descclassname">pyscf.ao2mo.outcore.</code><code class="descname">half_e1</code><span class="sig-paren">(</span><em>mol</em>, <em>mo_coeffs</em>, <em>swapfile</em>, <em>intor='int2e_sph'</em>, <em>aosym='s4'</em>, <em>comp=1</em>, <em>max_memory=2000</em>, <em>ioblk_size=256</em>, <em>verbose=2</em>, <em>compact=True</em>, <em>ao2mopt=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/ao2mo/outcore.html#half_e1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.ao2mo.outcore.half_e1" title="Permalink to this definition">¶</a></dt>
<dd><p>Half transform arbitrary spherical AO integrals to MO integrals
for the given two sets of orbitals</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>mol</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal"><span class="pre">Mole</span></code> object</span><dd>AO integrals will be generated in terms of mol._atm, mol._bas, mol._env</dd>
<dt>mo_coeff</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>Transform (ij|kl) with the same set of orbitals.</dd>
<dt>swapfile</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str or h5py File or h5py Group object</span><dd>To store the transformed integrals, in HDF5 format.  The transformed
integrals are saved in blocks.</dd>
</dl>
</dd>
<dt>Kwargs</dt>
<dd><dl class="first last docutils">
<dt>intor</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">str</span><dd>Name of the 2-electron integral.  Ref to <code class="xref py py-func docutils literal"><span class="pre">getints_by_shell()</span></code>
for the complete list of available 2-electron integral names</dd>
<dt>aosym</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int or str</span><dd><p class="first">Permutation symmetry for the AO integrals</p>
<div class="last line-block">
<div class="line">4 or &#8216;4&#8217; or &#8216;s4&#8217;: 4-fold symmetry (default)</div>
<div class="line">&#8216;2ij&#8217; or &#8216;s2ij&#8217; : symmetry between i, j in (ij|kl)</div>
<div class="line">&#8216;2kl&#8217; or &#8216;s2kl&#8217; : symmetry between k, l in (ij|kl)</div>
<div class="line">1 or &#8216;1&#8217; or &#8216;s1&#8217;: no symmetry</div>
<div class="line">&#8216;a4ij&#8217; : 4-fold symmetry with anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">&#8216;a4kl&#8217; : 4-fold symmetry with anti-symmetry between k, l in (ij|kl) (TODO)</div>
<div class="line">&#8216;a2ij&#8217; : anti-symmetry between i, j in (ij|kl) (TODO)</div>
<div class="line">&#8216;a2kl&#8217; : anti-symmetry between k, l in (ij|kl) (TODO)</div>
</div>
</dd>
<dt>comp</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Components of the integrals, e.g. int2e_ip_sph has 3 components.</dd>
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level</dd>
<dt>max_memory</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>The maximum size of cache to use (in MB), large cache may <strong>not</strong>
improve performance.</dd>
<dt>ioblk_size</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">float or int</span><dd>The block size for IO, large block size may <strong>not</strong> improve performance</dd>
<dt>verbose</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>Print level</dd>
<dt>compact</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">bool</span><dd>When compact is True, depending on the four oribital sets, the
returned MO integrals has (up to 4-fold) permutation symmetry.
If it&#8217;s False, the function will abandon any permutation symmetry,
and return the &#8220;plain&#8221; MO integrals</dd>
<dt>ao2mopt</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-class docutils literal"><span class="pre">AO2MOpt</span></code> object</span><dd>Precomputed data to improve perfomance</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>None</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyscf.ao2mo.addons">
<span id="addons"></span><h2>addons<a class="headerlink" href="#module-pyscf.ao2mo.addons" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyscf.ao2mo.addons.load">
<em class="property">class </em><code class="descclassname">pyscf.ao2mo.addons.</code><code class="descname">load</code><span class="sig-paren">(</span><em>eri</em>, <em>dataname='eri_mo'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/ao2mo/addons.html#load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.ao2mo.addons.load" title="Permalink to this definition">¶</a></dt>
<dd><p>load 2e integrals from hdf5 file</p>
<dl class="docutils">
<dt>Usage:</dt>
<dd><dl class="first last docutils">
<dt>with load(erifile) as eri:</dt>
<dd>print eri.shape</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyscf.ao2mo.addons.restore">
<code class="descclassname">pyscf.ao2mo.addons.</code><code class="descname">restore</code><span class="sig-paren">(</span><em>symmetry</em>, <em>eri</em>, <em>norb</em>, <em>tao=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyscf/ao2mo/addons.html#restore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyscf.ao2mo.addons.restore" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the 2e integrals between different level of permutation symmetry
(8-fold, 4-fold, or no symmetry)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>symmetry</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int or str</span><dd><p class="first">code to present the target symmetry of 2e integrals</p>
<div class="last line-block">
<div class="line">&#8216;s8&#8217; or &#8216;8&#8217; or 8 : 8-fold symmetry</div>
<div class="line">&#8216;s4&#8217; or &#8216;4&#8217; or 4 : 4-fold symmetry</div>
<div class="line">&#8216;s1&#8217; or &#8216;1&#8217; or 1 : no symmetry</div>
<div class="line">&#8216;s2ij&#8217; or &#8216;2ij&#8217; : symmetric ij pair for (ij|kl) (TODO)</div>
<div class="line">&#8216;s2ij&#8217; or &#8216;2kl&#8217; : symmetric kl pair for (ij|kl) (TODO)</div>
</div>
</dd>
<dt>eri</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span><dd>The symmetry of eri is determined by the size of eri and norb</dd>
<dt>norb</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int</span><dd>The symmetry of eri is determined by the size of eri and norb</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd><p class="first">ndarray.  The shape depends on the target symmetry.</p>
<blockquote class="last">
<div><div class="line-block">
<div class="line">8 : (norb*(norb+1)/2)*(norb*(norb+1)/2+1)/2</div>
<div class="line">4 : (norb*(norb+1)/2, norb*(norb+1)/2)</div>
<div class="line">1 : (norb, norb, norb, norb)</div>
</div>
</div></blockquote>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf.scf</span> <span class="k">import</span> <span class="n">_vhf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">ao2mo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">intor</span><span class="p">(</span><span class="s1">&#39;int2e&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri1</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">eri</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri4</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">eri</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eri8</span> <span class="o">=</span> <span class="n">ao2mo</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">eri</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">nao_nr</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(7, 7, 7, 7)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(28, 28)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">eri1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(406,)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mcscf.html" class="btn btn-neutral float-right" title="mcscf — Multi-configurational self-consistent field" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="scf.html" class="btn btn-neutral" title="scf — Mean-field methods" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-, Qiming Sun &lt;osirpt.sun@gmail.com&gt;.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.4.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: ''
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>