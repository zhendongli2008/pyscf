

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. An overview of PySCF &mdash; PySCF 1.5.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PySCF 1.5.0 documentation" href="index.html"/>
        <link rel="next" title="2. Tutorial" href="tutorial.html"/>
        <link rel="prev" title="Welcome to PySCF documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> PySCF
          

          
          </a>

          
            
            
              <div class="version">
                1.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. An overview of PySCF</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-to-cite">1.1. How to cite</a></li>
<li class="toctree-l2"><a class="reference internal" href="#features">1.2. Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#designs">1.3. Designs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kernel-and-stream-functions">1.3.1. Kernel and Stream functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pure-function-and-class">1.3.2. Pure function and Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#global-configurations">1.3.3. Global configurations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scanner">1.3.4. Scanner</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">2. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">3. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="gto.html">4. gto &#8212; Molecular structure and GTO basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="lib.html">5. <code class="docutils literal"><span class="pre">lib</span></code> &#8212; Helper functions, parameters, and C extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="scf.html">6. scf &#8212; Mean-field methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="ao2mo.html">7. ao2mo &#8212; Integral transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="mcscf.html">8. mcscf &#8212; Multi-configurational self-consistent field</a></li>
<li class="toctree-l1"><a class="reference internal" href="fci.html">9. fci &#8212; Full configuration interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="symm.html">10. symm &#8211; Point group symmetry and spin symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="df.html">11. df &#8212; Density fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="dft.html">12. dft &#8212; Density functional theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="tddft.html">13. tddft &#8212; Time dependent density functional theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="cc.html">14. cc &#8212; Coupled cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="ci.html">15. ci &#8212; Configuration interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dmrgscf.html">16. dmrgscf</a></li>
<li class="toctree-l1"><a class="reference internal" href="fciqmcscf.html">17. fciqmcscf</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">18. tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="grad.html">19. grad &#8212; Analytical nuclear gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="hessian.html">20. hessian &#8212; Analytical nuclear Hessian</a></li>
<li class="toctree-l1"><a class="reference internal" href="pbc.html">21. pbc &#8212; Periodic boundary conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="lo.html">22. lo &#8212; Orbital localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">23. Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="qmmm.html">24. qmmm &#8212; QM/MM interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="mrpt.html">25. mrpt &#8212; Multi-reference perturbation theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">26. Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="code-rule.html">27. Code standard</a></li>
<li class="toctree-l1"><a class="reference internal" href="version.html">28. Version history</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PySCF</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>1. An overview of PySCF</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/overview.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="an-overview-of-pyscf">
<h1>1. An overview of PySCF<a class="headerlink" href="#an-overview-of-pyscf" title="Permalink to this headline">¶</a></h1>
<p>Python-based simulations of chemistry framework (PySCF) is a general-purpose
electronic structure platform designed from the ground up to emphasize code
simplicity, so as to facilitate new method development and enable flexible
computational workflows. The package provides a wide range of tools to support
simulations of finite-size systems, extended systems with periodic boundary
conditions, low-dimensional periodic systems, and custom Hamiltonians, using
mean-field and post-mean-field methods with standard Gaussian basis functions.
To ensure ease of extensibility, PySCF uses the Python language to implement
almost all of its features, while computationally critical paths are
implemented with heavily optimized C routines. Using this combined Python/C
implementation, the package is as efficient as the best existing C or Fortran-
based quantum chemistry programs.</p>
<div class="section" id="how-to-cite">
<h2>1.1. How to cite<a class="headerlink" href="#how-to-cite" title="Permalink to this headline">¶</a></h2>
<p>Bibtex entry:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>@Misc{PYSCF,
  title = {PySCF: the Python‐based simulations of chemistry framework},
  author = {Qiming Sun and Timothy C. Berkelbach and Nick S. Blunt and George H. Booth and Sheng Guo and Zhendong Li and Junzi Liu and James D. McClain and Elvira R. Sayfutyarova and Sandeep Sharma and Sebastian Wouters and Garnet Kin‐Lic Chan},
  year = {2017}
  journal = {Wiley Interdisciplinary Reviews: Computational Molecular Science},
  volume = {8},
  number = {1},
  pages = {e1340},
  doi = {10.1002/wcms.1340},
  url = {https://onlinelibrary.wiley.com/doi/abs/10.1002/wcms.1340},
  eprint = {https://onlinelibrary.wiley.com/doi/pdf/10.1002/wcms.1340},
}
</pre></div>
</div>
</div>
<div class="section" id="features">
<h2>1.2. Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Hartree-Fock (up to ~5000 basis)<ul>
<li>Non-relativistic restricted open-shell, unrestricted HF</li>
<li>Scalar relativistic HF</li>
<li>2-component relativistic HF</li>
<li>4-component relativistic Dirac-Hartree-Fock</li>
<li>Density fitting HF</li>
<li>Second order SCF</li>
<li>General JK contraction function</li>
<li>DIIS, EDIIS, ADIIS and second order solver</li>
<li>SCF wavefunction stability analysis</li>
<li>Generalized Hartree-Fock (GHF)</li>
</ul>
</li>
<li>DFT (up to ~5000 basis)<ul>
<li>Non-relativistic restricted, restricted open-shell, unrestricted Kohn-Sham</li>
<li>Scalar relativistic DFT</li>
<li>Density fitting DFT</li>
<li>General XC functional evaluator (for Libxc or XcFun)</li>
<li>General AO evaluator</li>
<li>VV10 NLC functional for finite size systems</li>
<li>range-separated hybrid features for RKS and UKS, including
&gt; Analytical nuclear gradients
&gt; Second order SCF
&gt; Hessian and frequency
&gt; TDDFT
&gt; TDDFT nuclear gradients
&gt; NMR</li>
</ul>
</li>
<li>TDSCF/TDDFT<ul>
<li>TDA (and density-fitting TDA) for RHF, UHF, RKS and UKS methods</li>
<li>TDHF (and density-fitting TDHF) for RHF and UHF methods</li>
<li>TDDFT (and density-fitting TDDFT) for RKS and UKS methods</li>
<li>TDA nuclear gradients for RHF, UHF, RKS and UKS methods</li>
<li>TDHF nuclear gradients for RHF and UHF methods</li>
<li>TDDFT nuclear gradients for RKS and UKS methods</li>
<li>Natural transition orbital analysis</li>
<li>direct-RPA (no exchange, aka TDH)</li>
<li>direct-TDA (TDA without exchange)</li>
</ul>
</li>
<li>GW methods
- G0W0 approximation</li>
<li>General CASCI/CASSCF solver (up to ~3000 basis)<ul>
<li>State-average CASCI/CASSCF</li>
<li>State-specific CASCI/CASSCF for excited states</li>
<li>Multiple roots CASCI</li>
<li>Support DMRG as plugin FCI solver to do DMRG-CASSCF</li>
<li>Support FCIQMC as plugin FCI solver to do FCIQMC-CASSCF</li>
<li>Support Selected CI algorithm as plugin FCI solver to do SHCI-CASSCF</li>
<li>UCASSCF</li>
<li>Density-fitting CASSCF</li>
<li>DMET-CAS and AVAS active space constructor</li>
<li>CASCI and CASSCF analytical nuclear gradients</li>
</ul>
</li>
<li>MP2 (up to ~200 occupied, ~2000 virtual orbitals)<ul>
<li>Canonical RMP2, UMP2, GMP2</li>
<li>Density-fitting RMP2</li>
<li>RMP2, UMP2 and GMP2 1-particle and 2-particle density matrices</li>
<li>RMP2 and UMP2 nuclear gradients</li>
</ul>
</li>
<li>CCSD (up to ~100 occupied, ~1500 virtual orbitals)<ul>
<li>canonical RCCSD, UCCSD</li>
<li>canonical RCCSD, UCCSD lambda solver</li>
<li>RCCSD, UCCSD and GCCSD 1-particle and 2-particle density matrices</li>
<li>RCCSD and UCCSD nuclear gradients</li>
<li>EOM-IP/EA/EE-RCCSD and EOM-IP/EA/EE-UCCSD</li>
<li>RCC2</li>
<li>Density-fitting RCCSD</li>
</ul>
</li>
<li>CCSD(T)<ul>
<li>RCCSD(T) and UCCSD(T)</li>
<li>RCCSD(T), UCCSD(T) and GCCSD(T) 1- and 2-particle density matrices</li>
<li>RCCSD(T) and UCCSD(T) analytical nuclear gradients</li>
</ul>
</li>
<li>CI<ul>
<li>RCISD, UCISD and GCISD</li>
<li>RCISD, UCISD and GCISD 1, 2-particle density matrices</li>
<li>Selected-CI</li>
<li>Selected-CI 1, 2-particle density matrices</li>
<li>RCISD, UCISD and GCISD 1-particle transition density matrices</li>
</ul>
</li>
<li>Full CI<ul>
<li>Direct-CI solver for spin degenerated Hamiltonian (RHF-FCI)</li>
<li>Direct-CI solver for spin non-degenerated Hamiltonian (UHF-FCI)</li>
<li>1, and 2-particle transition density matrices</li>
<li>1, 2, 3, and 4-particle density matrices</li>
<li>CI wavefunction overlap</li>
</ul>
</li>
<li>Analytical Nuclear Gradients<ul>
<li>Non-relativistic HF nuclear gradients</li>
<li>4-component DHF nuclear gradients</li>
<li>Non-relativistic DFT nuclear gradients</li>
<li>Non-relativistic CISD nuclear gradients</li>
<li>Non-relativistic CCSD and CCSD(T) nuclear gradients</li>
<li>Non-relativistic CASCI and CASSCF nuclear gradients</li>
<li>Non-relativistic TDA, TDHF and TDDFT nuclear gradients</li>
<li>Non-relativistic nuclear gradients with SF-X2C-1e correction</li>
<li>ECP nuclear gradients</li>
<li>nuclear gradients for solvent model ddCOSMO</li>
<li>Frozen orbitals for MP2, CISD, CCSD, CCSD(T), CASCI, CASSCF nuclear gradients</li>
</ul>
</li>
<li>Nuclear Hessian<ul>
<li>Non-relativistic HF nuclear hessian</li>
<li>Non-relativistic DFT nuclear hessian</li>
<li>Non-relativistic nuclear hessian with SF-X2C-1e correction</li>
<li>ECP nuclear hessian</li>
</ul>
</li>
<li>Properties<ul>
<li>Non-relativistic RHF, UHF, RKS, UKS NMR shielding</li>
<li>4-component DHF NMR shielding</li>
<li>Non-relativistic RHF, UHF spin-spin coupling</li>
<li>4-component DHF spin-spin coupling</li>
<li>Non-relativistic UHF, UKS hyperfine coupling</li>
<li>4-component DHF hyperfine coupling</li>
<li>Non-relativistic UHF, UKS g-tensor</li>
<li>4-component DHF g-tensor</li>
<li>Non-relativistic UHF zero-field splitting</li>
<li>Molecular electrostatic potential (MEP)</li>
</ul>
</li>
<li>MRPT<ul>
<li>Strongly contracted NEVPT2 (SC-NEVPT2)</li>
<li>DMRG-NEVPT2</li>
<li>IC-MPS-PT2</li>
</ul>
</li>
<li>Extended systems with periodic boundary condition<ul>
<li>gamma point RHF, UHF, RKS, UKS</li>
<li>gamma point TDDFT, MP2, CCSD</li>
<li>RHF, UHF, GHF, RKS, UKS with k-point sampling</li>
<li>Restricted MP2 with k-point sampling</li>
<li>RCCSD with k-point sampling (KRCCSD)</li>
<li>Generalized CCSD with k-point sampling (KGCCSD)</li>
<li>k-point GCCSD(T) and RCCSD(T)</li>
<li>k-point EOM-IP/EA-CCSD</li>
<li>PBC AO integrals</li>
<li>PBC MO integral transformation</li>
<li>PBC density fitting and mixed-density fitting methods</li>
<li>Smearing for mean-field methods</li>
<li>Low-dimensional (0D, 1D, 2D) PBC systems</li>
<li>(restricted and unrestricted) TDA, TDHF and TDDFT with k-point sampling</li>
</ul>
</li>
<li>AO integrals<ul>
<li>Interface to call Libcint library</li>
<li>1-electron real-GTO and spinor-GTO integrals</li>
<li>2-electron real-GTO and spinor-GTO integrals</li>
<li>3-center 1-electron real-GTO and spinor-GTO integrals</li>
<li>3-center 2-electron real-GTO and spinor-GTO integrals</li>
<li>General basis value evaluator (for numeric integration)</li>
<li>PBC 1-electron integrals</li>
<li>PBC 2-electron integrals</li>
<li>F12 integrals</li>
</ul>
</li>
<li>MO integrals<ul>
<li>2-electron integral transformation for any integrals provided by
Libcint library</li>
<li>Support for 4-index integral transformation with 4 different orbitals</li>
<li>PBC 2-electron MO integrals</li>
</ul>
</li>
<li>Localizer<ul>
<li>Boys</li>
<li>Edmiston</li>
<li>Meta-Lowdin for both finite size and PBC systems</li>
<li>Natural atomic orbital (NAO) for both finite size and PBC systems</li>
<li>Intrinsic atomic orbital (IAO) for both finite size and PBC systems</li>
<li>Pipek-Mezey for both finite size and PBC systems</li>
<li>Intrinsic bond orbital (IBO) for both finite size and PBC systems</li>
</ul>
</li>
<li>Geometry optimization<ul>
<li>HF, DFT, CCSD, CCSD(T), CISD, CASCI, CASSCF and TDSCF/TDDFT with pyberny
geometry optimizer</li>
</ul>
</li>
<li>D2h symmetry and linear molecule symmetry<ul>
<li>Molecule symmetry detection</li>
<li>Symmetry adapted basis</li>
<li>Label orbital symmetry on the fly</li>
<li>Hot update symmetry information</li>
<li>Function to symmetrize given orbital space</li>
</ul>
</li>
<li>Solvent model
- ddCOSMO
- ddPCM
- ddCOSMO analytical nuclear gradients</li>
<li>Tools<ul>
<li>fcidump writer</li>
<li>molden writer and reader</li>
<li>cubegen writer</li>
<li>Molpro XML reader</li>
<li>(GAMESS-format) wfn writer</li>
<li>Vasp CHGCAR-format writer</li>
</ul>
</li>
<li>Interface to integral package <a class="reference external" href="https://github.com/sunqm/libcint">Libcint</a></li>
<li>Interface to DMRG <a class="reference external" href="https://github.com/SebWouters/CheMPS2">CheMPS2</a></li>
<li>Interface to DMRG <a class="reference external" href="https://github.com/sanshar/Block">Block</a></li>
<li>Interface to FCIQMC <a class="reference external" href="https://github.com/ghb24/NECI_STABLE">NECI</a></li>
<li>Interface to XC functional library <a class="reference external" href="https://github.com/dftlibs/xcfun">XCFun</a></li>
<li>Interface to XC functional library <a class="reference external" href="http://www.tddft.org/programs/octopus/wiki/index.php/Libxc">Libxc</a></li>
<li>Interface to tensor contraction library <a class="reference external" href="https://github.com/devinamatthews/tblis">TBLIS</a></li>
<li>Interface to Heat-bath Selected CI program <a class="reference external" href="https://sanshar.github.io/Dice/">Dice</a></li>
<li>Interface to geometry optimizer <a class="reference external" href="https://github.com/azag0/pyberny">Pyberny</a></li>
</ul>
</div>
<div class="section" id="designs">
<h2>1.3. Designs<a class="headerlink" href="#designs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="kernel-and-stream-functions">
<h3>1.3.1. Kernel and Stream functions<a class="headerlink" href="#kernel-and-stream-functions" title="Permalink to this headline">¶</a></h3>
<p>Every class has the <code class="docutils literal"><span class="pre">kernel</span></code> method which serves as the entry or the driver of
the method. Once an object of one method was created, you can always call
<code class="docutils literal"><span class="pre">.kernel()</span></code> to start or restart a calculation.</p>
<p>The return value of kernel method is different for different class. To unify the
return value, the package introduces the stream methods to pipe the computing
stream.  A stream method of an object only return the object itself.  There are
three general stream methods available for most method classes. They are:</p>
<p>1 <code class="docutils literal"><span class="pre">.set</span></code> method to update object attributes, for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">conv_tol</span><span class="o">=</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>is identical to two lines of statements:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">5</span>
</pre></div>
</div>
<p>2 <code class="docutils literal"><span class="pre">.run</span></code> method to pass the call to the <code class="docutils literal"><span class="pre">.kernel</span></code> method.  If arguments are
presented in <code class="docutils literal"><span class="pre">.run</span></code> method, the arguments will be passed to the kernel
function.  If keyword arguments are given, <code class="docutils literal"><span class="pre">.run</span></code> method will first
call <code class="docutils literal"><span class="pre">.set</span></code> method to update the attributes then execute the <code class="docutils literal"><span class="pre">.kernel</span></code>
method.  For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">dm_init</span><span class="p">,</span> <span class="n">conv_tol</span><span class="o">=</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>is identical to three lines of statements:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="n">conv_tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">5</span>
<span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">dm_init</span><span class="p">)</span>
</pre></div>
</div>
<p>3 <code class="docutils literal"><span class="pre">.apply</span></code> method to pass the current object (as the first argument) to the
given function/class and return a new object.  If arguments and keyword
arguments are presented, they will all be passed to the function/class. For
example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mc</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>is identical to:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">mf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">mcscf</span><span class="o">.</span><span class="n">CASSCF</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>Aside from the three general stream methods, the regular class methods may
return the objects as well when the methods do not have particular value to
return.  Using the stream methods, you can evaluate certain quantities with one
line of code:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dm</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1&#39;</span><span class="p">)</span> \
<span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">)</span> \
<span class="o">.</span><span class="n">dump_flags</span><span class="p">()</span> \
<span class="o">.</span><span class="n">run</span><span class="p">()</span> \
<span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="pure-function-and-class">
<h3>1.3.2. Pure function and Class<a class="headerlink" href="#pure-function-and-class" title="Permalink to this headline">¶</a></h3>
<p>Class are designed to hold only the final results and the control parameters
such as maximum number of iterations, convergence threshold, etc.
Intermediates are NOT saved in the class.  After calling the <code class="docutils literal"><span class="pre">.kernel()</span></code> or
<code class="docutils literal"><span class="pre">.run()</span></code> method, results will be generated and saved in the object. For
example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">ccsd</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 1.1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;ccpvtz&#39;</span><span class="p">)</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">mycc</span> <span class="o">=</span> <span class="n">ccsd</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mycc</span><span class="o">.</span><span class="n">e_tot</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mycc</span><span class="o">.</span><span class="n">e_corr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mycc</span><span class="o">.</span><span class="n">t1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mycc</span><span class="o">.</span><span class="n">t2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p>Many useful functions are defined at both the module level and class level. They
can be accessed from either the module functions or the class methods and the
return values should be the same:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vj</span><span class="p">,</span> <span class="n">vk</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">hf</span><span class="o">.</span><span class="n">get_jk</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
<span class="n">vj</span><span class="p">,</span> <span class="n">vk</span> <span class="o">=</span> <span class="n">SCF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">get_jk</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
<p>Note some module functions may require the class as the first argument.</p>
<p>Most functions and classes are <strong>pure</strong>, i.e. no intermediate status are held
within the classes, and the argument of the methods and functions are immutable
during calculations.  These functions can be called arbitrary times in
arbitrary order and their returns should be always the same.</p>
<p>Exceptions are often suffixed with underscore in the function name, e.g.
<code class="docutils literal"><span class="pre">mcscf.state_average_(mc)</span></code> where the attributes of <code class="docutils literal"><span class="pre">mc</span></code> object may be
changed or overwritten by the <code class="docutils literal"><span class="pre">state_average_</span></code> method.  Cautious should be
taken when you see the functions or methods with ugly suffices.</p>
</div>
<div class="section" id="global-configurations">
<span id="global-config"></span><h3>1.3.3. Global configurations<a class="headerlink" href="#global-configurations" title="Permalink to this headline">¶</a></h3>
<p>Global configuration file is a Python script that contains PySCF configurations.
When importing <code class="docutils literal"><span class="pre">pyscf</span></code> module in a Python program (or Python interpreter), the
package will preload the global configuration file and take the configurations
as the default values of the parameters of functions or attributes of classes
during initialization.  For example, the configuration file below detects the
available memory in the operate system at the runtime and set the maximum memory
for PySCF:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ cat ~/.pyscf_conf.py
import psutil
total, available, percent, used, free, active, inactive, buffers, cached, shared = psutil.virtual_memory()
MAX_MEMORY = available
</pre></div>
</div>
<p>By setting <code class="docutils literal"><span class="pre">MAX_MEMORY</span></code> in the global configuration file, you don&#8217;t need the
statement to set the <code class="docutils literal"><span class="pre">max_memory</span></code> attribute in every script. The dynamically
determined <code class="docutils literal"><span class="pre">max_memory</span></code> will be loaded during the program initialization step
automatically.</p>
<p>There are two methods to let the PySCF package load the global configurations.
One is to create a configuration file <code class="docutils literal"><span class="pre">.pyscf_conf.py</span></code> in home directory or
in work directory.  Another is to set the environment variable
<code class="docutils literal"><span class="pre">PYSCF_CONFIG_FILE</span></code> which points to the configuration file (with the absolute
path).  The environment variable <code class="docutils literal"><span class="pre">PYSCF_CONFIG_FILE</span></code> has high priority than
the configuration file in default locations (home directory or work directory).
If environment variable <code class="docutils literal"><span class="pre">PYSCF_CONFIG_FILE</span></code> is available, the program will
read the configurations from the <code class="docutils literal"><span class="pre">$PYSCF_CONFIG_FILE</span></code>. If
<code class="docutils literal"><span class="pre">PYSCF_CONFIG_FILE</span></code> is not set or the file it points to does not exist, the
program will turn to the default location for the file <code class="docutils literal"><span class="pre">.pyscf_conf.py</span></code>.  If
none of the configuration file exists, the program will use the built-in
configurations which are generally conservative settings.</p>
<p>In the source code, global configurations are loaded by importing
<code class="xref py py-mod docutils literal"><span class="pre">pyscf.__config__</span></code> module:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="k">import</span> <span class="n">__config__</span>
<span class="n">MAX_MEMORY</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">__config__</span><span class="p">,</span> <span class="s1">&#39;MAX_MEMORY&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Please refer to the source code for the available configurations.</p>
</div>
<div class="section" id="scanner">
<span id="id1"></span><h3>1.3.4. Scanner<a class="headerlink" href="#scanner" title="Permalink to this headline">¶</a></h3>
<p>Scanner is a function that takes an <code class="docutils literal"><span class="pre">Mole</span></code> (or <code class="docutils literal"><span class="pre">Cell</span></code>) object as input and
return the energy or nuclear gradients of the given <code class="docutils literal"><span class="pre">Mole</span></code> (or <code class="docutils literal"><span class="pre">Cell</span></code>)
object.  Scanner can be considered as a shortcut function for a sequence of
statements which includes the initialization of a required calculation model
with necessary precomputing, next updating the attributes based on the settings
of the referred object, then calling kernel function and finally returning
results.  For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cc_scanner</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">)</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">):</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">cc_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 </span><span class="si">%g</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">r</span><span class="p">)))</span>
</pre></div>
</div>
<p>An equivalent but slightly complicated code is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">):</span>
  <span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 </span><span class="si">%g</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">r</span><span class="p">)</span>
  <span class="n">mf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
  <span class="n">mycc</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">CCSD</span><span class="p">(</span><span class="n">mf</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">mycc</span><span class="o">.</span><span class="n">e_tot</span><span class="p">)</span>
</pre></div>
</div>
<p>There are two types of scanner available in the package.  They are <em>energy
scanner</em> and <em>nuclear gradients scanner</em>.  The example above is the energy
scanner.  Energy scanner only returns the energy of the given molecular
structure while the nuclear gradients scanner returns the nuclear gradients in
addition.</p>
<p>Scanner is a special derived object of the caller.  Most methods which are
defined in the caller class can be used with the scanner object. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mf_scanner</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">)</span><span class="o">.</span><span class="n">as_scanner</span><span class="p">()</span>
<span class="n">mf_scanner</span><span class="p">(</span><span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H 0 0 0; H 0 0 </span><span class="si">%g</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">r</span><span class="p">))</span>
<span class="n">mf_scanner</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
<span class="n">dm1</span> <span class="o">=</span> <span class="n">mf_scanner</span><span class="o">.</span><span class="n">make_rdm1</span><span class="p">()</span>
</pre></div>
</div>
<p>As shown in the example above, the scanner works pretty close to the relevant
class object except that the scanner does not need the <code class="docutils literal"><span class="pre">kernel</span></code> or <code class="docutils literal"><span class="pre">run</span></code>
methods to run a calculation.  Given molecule structure, the scanner
automatically checks and updates the necessary object dependence and passes the
work flow to the <code class="docutils literal"><span class="pre">kernel</span></code> method.  The computational results are held in the
scanner object as the regular class object does.</p>
<p>To make structure of scanner object uniform for all methods, two attributes
(<code class="docutils literal"><span class="pre">.e_tot</span></code> and <code class="docutils literal"><span class="pre">.converged</span></code>) are defined for all energy scanner
and three attributes (<code class="docutils literal"><span class="pre">.e_tot</span></code>, <code class="docutils literal"><span class="pre">.de</span></code> and <code class="docutils literal"><span class="pre">.converged</span></code>) are defined for
all nuclear gradients scanner.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial.html" class="btn btn-neutral float-right" title="2. Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to PySCF documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-, Qiming Sun &lt;osirpt.sun@gmail.com&gt;.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.5.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: ''
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>